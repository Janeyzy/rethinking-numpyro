<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Chapter 2. Small Worlds and Large Worlds | Statistical Rethinking (2nd ed.) with NumPyro</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://fehiepsi.github.io/rethinking-numpyro/02-small-worlds-and-large-worlds.html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><meta name="author" content="fehiepsi">
<meta property="og:site_name" content="Statistical Rethinking (2nd ed.) with NumPyro">
<meta property="og:title" content="Chapter 2. Small Worlds and Large Worlds">
<meta property="og:url" content="https://fehiepsi.github.io/rethinking-numpyro/02-small-worlds-and-large-worlds.html">
<meta property="og:description" content="&lt; Chapter 1. The Golem of Prague | Chapter 3. Sampling the Imaginary &gt;

    
    
    
    









In [0]:

    
import arviz as az
import matplotlib.pyplot as plt

from jax import lax
import jax.nu">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-10-29T00:46:35-04:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="https://fehiepsi.github.io/rethinking-numpyro/">

            <span id="blog-title">Statistical Rethinking (2nd ed.) with NumPyro</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav"></ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100"></ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Chapter 2. Small Worlds and Large Worlds</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="01-the-golem-of-prague.html">Chapter 1. The Golem of Prague</a> | <a href="03-sampling-the-imaginary.html">Chapter 3. Sampling the Imaginary</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">jax</span> <span class="k">import</span> <span class="n">lax</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">jax.random</span> <span class="k">import</span> <span class="n">PRNGKey</span>

<span class="kn">import</span> <span class="nn">numpyro</span> <span class="k">as</span> <span class="nn">npyro</span>
<span class="kn">from</span> <span class="nn">numpyro.contrib.autoguide</span> <span class="k">import</span> <span class="p">(</span><span class="n">AutoContinuousELBO</span><span class="p">,</span>
                                       <span class="n">AutoLaplaceApproximation</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="kn">from</span> <span class="nn">numpyro.infer</span> <span class="k">import</span> <span class="n">SVI</span>
<span class="kn">import</span> <span class="nn">numpyro.optim</span> <span class="k">as</span> <span class="nn">optim</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = ["svg"]
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"arviz-darkgrid"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.1">Code 2.1<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.1">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ways</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ways</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ways</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[1]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([0.        , 0.15000001, 0.40000001, 0.45000002, 0.        ],
            dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.2">Code 2.2<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.2">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="n">total_count</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">probs</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[2]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0.16406263, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.3">Code 2.3<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.3">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># define grid</span>
<span class="n">p_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># define prior</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># compute likelihood at each value in grid</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="n">total_count</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">probs</span><span class="o">=</span><span class="n">p_grid</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># compute product of likelihood and prior</span>
<span class="n">unstd_posterior</span> <span class="o">=</span> <span class="n">likelihood</span> <span class="o">*</span> <span class="n">prior</span>

<span class="c1"># standardize the posterior, so it sums to 1</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">unstd_posterior</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">unstd_posterior</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.4">Code 2.4<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.4">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_grid</span><span class="p">,</span> <span class="n">posterior</span><span class="p">,</span> <span class="s2">"-o"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"probability of water"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"posterior probability"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"20 points"</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[4]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="285.564063pt" version="1.1" viewbox="0 0 411.296562 285.564063" width="411.296562pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 285.564063 
L 411.296562 285.564063 
L 411.296562 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 69.296563 242.7975 
L 404.096563 242.7975 
L 404.096563 25.3575 
L 69.296563 25.3575 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#p88d6a03e4d)" d="M 84.514744 242.7975 
L 84.514744 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 0.0 --><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path></defs><g style="fill:#262626;" transform="translate(73.382557 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#p88d6a03e4d)" d="M 145.387472 242.7975 
L 145.387472 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 0.2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(134.255284 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#p88d6a03e4d)" d="M 206.260199 242.7975 
L 206.260199 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.4 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(195.128011 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#p88d6a03e4d)" d="M 267.132926 242.7975 
L 267.132926 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 0.6 --><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(256.000739 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-54"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#p88d6a03e4d)" d="M 328.005653 242.7975 
L 328.005653 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 0.8 --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(316.873466 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#p88d6a03e4d)" d="M 388.878381 242.7975 
L 388.878381 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 1.0 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(377.746193 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="text_7"><!-- probability of water --><defs><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path><path d="M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
M 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
z
" id="DejaVuSans-98"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path><path id="DejaVuSans-32"></path><path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path><path d="M 4.203125 54.6875 
L 13.1875 54.6875 
L 24.421875 12.015625 
L 35.59375 54.6875 
L 46.1875 54.6875 
L 57.421875 12.015625 
L 68.609375 54.6875 
L 77.59375 54.6875 
L 63.28125 0 
L 52.6875 0 
L 40.921875 44.828125 
L 29.109375 0 
L 18.5 0 
z
" id="DejaVuSans-119"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path></defs><g style="fill:#262626;" transform="translate(163.152031 275.244531)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-112"></use><use x="63.476562" xlink:href="#DejaVuSans-114"></use><use x="104.558594" xlink:href="#DejaVuSans-111"></use><use x="165.740234" xlink:href="#DejaVuSans-98"></use><use x="229.216797" xlink:href="#DejaVuSans-97"></use><use x="290.496094" xlink:href="#DejaVuSans-98"></use><use x="353.972656" xlink:href="#DejaVuSans-105"></use><use x="381.755859" xlink:href="#DejaVuSans-108"></use><use x="409.539062" xlink:href="#DejaVuSans-105"></use><use x="437.322266" xlink:href="#DejaVuSans-116"></use><use x="476.53125" xlink:href="#DejaVuSans-121"></use><use x="535.710938" xlink:href="#DejaVuSans-32"></use><use x="567.498047" xlink:href="#DejaVuSans-111"></use><use x="628.679688" xlink:href="#DejaVuSans-102"></use><use x="663.884766" xlink:href="#DejaVuSans-32"></use><use x="695.671875" xlink:href="#DejaVuSans-119"></use><use x="777.458984" xlink:href="#DejaVuSans-97"></use><use x="838.738281" xlink:href="#DejaVuSans-116"></use><use x="877.947266" xlink:href="#DejaVuSans-101"></use><use x="939.470703" xlink:href="#DejaVuSans-114"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_13"><path clip-path="url(#p88d6a03e4d)" d="M 69.296563 232.913864 
L 404.096563 232.913864 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_8"><!-- 0.000 --><g style="fill:#262626;" transform="translate(25.717188 238.23277)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use><use x="159.033203" xlink:href="#DejaVuSans-48"></use><use x="222.65625" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_15"><path clip-path="url(#p88d6a03e4d)" d="M 69.296563 198.31575 
L 404.096563 198.31575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_9"><!-- 0.025 --><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><g style="fill:#262626;" transform="translate(25.717188 203.634656)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use><use x="159.033203" xlink:href="#DejaVuSans-50"></use><use x="222.65625" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_3"><g id="line2d_17"><path clip-path="url(#p88d6a03e4d)" d="M 69.296563 163.717636 
L 404.096563 163.717636 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_10"><!-- 0.050 --><g style="fill:#262626;" transform="translate(25.717188 169.036542)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use><use x="159.033203" xlink:href="#DejaVuSans-53"></use><use x="222.65625" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_4"><g id="line2d_19"><path clip-path="url(#p88d6a03e4d)" d="M 69.296563 129.119522 
L 404.096563 129.119522 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_11"><!-- 0.075 --><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><g style="fill:#262626;" transform="translate(25.717188 134.438429)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use><use x="159.033203" xlink:href="#DejaVuSans-55"></use><use x="222.65625" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_5"><g id="line2d_21"><path clip-path="url(#p88d6a03e4d)" d="M 69.296563 94.521409 
L 404.096563 94.521409 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_22"></g><g id="text_12"><!-- 0.100 --><g style="fill:#262626;" transform="translate(25.717188 99.840315)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-49"></use><use x="159.033203" xlink:href="#DejaVuSans-48"></use><use x="222.65625" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_6"><g id="line2d_23"><path clip-path="url(#p88d6a03e4d)" d="M 69.296563 59.923295 
L 404.096563 59.923295 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_24"></g><g id="text_13"><!-- 0.125 --><g style="fill:#262626;" transform="translate(25.717188 65.242201)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-49"></use><use x="159.033203" xlink:href="#DejaVuSans-50"></use><use x="222.65625" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="text_14"><!-- posterior probability --><defs><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path></defs><g style="fill:#262626;" transform="translate(18.597656 210.292734)rotate(-90)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-112"></use><use x="63.476562" xlink:href="#DejaVuSans-111"></use><use x="124.658203" xlink:href="#DejaVuSans-115"></use><use x="176.757812" xlink:href="#DejaVuSans-116"></use><use x="215.966797" xlink:href="#DejaVuSans-101"></use><use x="277.490234" xlink:href="#DejaVuSans-114"></use><use x="318.603516" xlink:href="#DejaVuSans-105"></use><use x="346.386719" xlink:href="#DejaVuSans-111"></use><use x="407.568359" xlink:href="#DejaVuSans-114"></use><use x="448.681641" xlink:href="#DejaVuSans-32"></use><use x="480.46875" xlink:href="#DejaVuSans-112"></use><use x="543.945312" xlink:href="#DejaVuSans-114"></use><use x="585.027344" xlink:href="#DejaVuSans-111"></use><use x="646.208984" xlink:href="#DejaVuSans-98"></use><use x="709.685547" xlink:href="#DejaVuSans-97"></use><use x="770.964844" xlink:href="#DejaVuSans-98"></use><use x="834.441406" xlink:href="#DejaVuSans-105"></use><use x="862.224609" xlink:href="#DejaVuSans-108"></use><use x="890.007812" xlink:href="#DejaVuSans-105"></use><use x="917.791016" xlink:href="#DejaVuSans-116"></use><use x="957" xlink:href="#DejaVuSans-121"></use></g></g></g><g id="line2d_25"><path clip-path="url(#p88d6a03e4d)" d="M 84.514744 232.913864 
L 100.533883 232.912758 
L 116.553022 232.854248 
L 132.572159 232.347728 
L 148.5913 230.292866 
L 164.610441 224.784861 
L 180.629573 213.479503 
L 196.648714 194.369149 
L 212.667855 166.760686 
L 228.686996 132.153913 
L 244.706138 94.69723 
L 260.72527 60.941407 
L 276.744402 38.729444 
L 292.763552 35.241136 
L 308.782684 54.466052 
L 324.801834 94.697292 
L 340.820966 147.029034 
L 356.840098 196.302454 
L 372.859249 226.465238 
L 388.878381 232.913864 
" style="fill:none;stroke:#2a2eec;stroke-linecap:round;stroke-width:1.5;"></path><defs><path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m5de547fd1c" style="stroke:#2a2eec;"></path></defs><g clip-path="url(#p88d6a03e4d)"><use style="fill:#2a2eec;stroke:#2a2eec;" x="84.514744" xlink:href="#m5de547fd1c" y="232.913864"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="100.533883" xlink:href="#m5de547fd1c" y="232.912758"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="116.553022" xlink:href="#m5de547fd1c" y="232.854248"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="132.572159" xlink:href="#m5de547fd1c" y="232.347728"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="148.5913" xlink:href="#m5de547fd1c" y="230.292866"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="164.610441" xlink:href="#m5de547fd1c" y="224.784861"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="180.629573" xlink:href="#m5de547fd1c" y="213.479503"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="196.648714" xlink:href="#m5de547fd1c" y="194.369149"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="212.667855" xlink:href="#m5de547fd1c" y="166.760686"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="228.686996" xlink:href="#m5de547fd1c" y="132.153913"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="244.706138" xlink:href="#m5de547fd1c" y="94.69723"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="260.72527" xlink:href="#m5de547fd1c" y="60.941407"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="276.744402" xlink:href="#m5de547fd1c" y="38.729444"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="292.763552" xlink:href="#m5de547fd1c" y="35.241136"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="308.782684" xlink:href="#m5de547fd1c" y="54.466052"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="324.801834" xlink:href="#m5de547fd1c" y="94.697292"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="340.820966" xlink:href="#m5de547fd1c" y="147.029034"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="356.840098" xlink:href="#m5de547fd1c" y="196.302454"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="372.859249" xlink:href="#m5de547fd1c" y="226.465238"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="388.878381" xlink:href="#m5de547fd1c" y="232.913864"></use></g></g><g id="patch_3"><path d="M 69.296563 242.7975 
L 69.296563 25.3575 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 404.096563 242.7975 
L 404.096563 25.3575 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 69.296563 242.7975 
L 404.096563 242.7975 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 69.296563 25.3575 
L 404.096563 25.3575 
" style="fill:none;"></path></g><g id="text_15"><!-- 20 points --><defs><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path></defs><g style="fill:#262626;" transform="translate(199.404063 19.3575)scale(0.16 -0.16)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-32"></use><use x="159.033203" xlink:href="#DejaVuSans-112"></use><use x="222.509766" xlink:href="#DejaVuSans-111"></use><use x="283.691406" xlink:href="#DejaVuSans-105"></use><use x="311.474609" xlink:href="#DejaVuSans-110"></use><use x="374.853516" xlink:href="#DejaVuSans-116"></use><use x="414.0625" xlink:href="#DejaVuSans-115"></use></g></g></g></g><defs><clippath id="p88d6a03e4d"><rect height="217.44" width="334.8" x="69.296563" y="25.3575"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.5">Code 2.5<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.5">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p_grid</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">p_grid</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.6">Code 2.6<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.6">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"p"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># uniform prior</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"W"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="n">L</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>  <span class="c1"># binomial likelihood</span>

<span class="n">guide</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">guide</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span> <span class="n">W</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">fori_loop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">init_state</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="c1"># display summary of quadratic approximation</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">guide</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">params</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">npyro</span><span class="o">.</span><span class="n">diagnostics</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.89</span><span class="p">,</span> <span class="n">group_by_chain</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[6]:</span>
</div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>

                mean       std    median      5.5%     94.5%     n_eff     r_hat
         p      0.62      0.14      0.63      0.41      0.84    845.27      1.00


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.7">Code 2.7<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.7">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># analytical calculation</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="c1"># quadratic approximation</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.61</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s2">"--"</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[7]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="248.889375pt" version="1.1" viewbox="0 0 374.964375 248.889375" width="374.964375pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 248.889375 
L 374.964375 248.889375 
L 374.964375 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 32.964375 224.64 
L 367.764375 224.64 
L 367.764375 7.2 
L 32.964375 7.2 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#pf2198cf947)" d="M 48.182557 224.64 
L 48.182557 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 0.0 --><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path></defs><g style="fill:#262626;" transform="translate(37.050369 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#pf2198cf947)" d="M 109.055284 224.64 
L 109.055284 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 0.2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(97.923097 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#pf2198cf947)" d="M 169.928011 224.64 
L 169.928011 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.4 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(158.795824 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#pf2198cf947)" d="M 230.800739 224.64 
L 230.800739 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 0.6 --><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(219.668551 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-54"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#pf2198cf947)" d="M 291.673466 224.64 
L 291.673466 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 0.8 --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(280.541278 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#pf2198cf947)" d="M 352.546193 224.64 
L 352.546193 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 1.0 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(341.414006 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_13"><path clip-path="url(#pf2198cf947)" d="M 32.964375 214.756364 
L 367.764375 214.756364 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_7"><!-- 0.0 --><g style="fill:#262626;" transform="translate(7.2 220.07527)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_15"><path clip-path="url(#pf2198cf947)" d="M 32.964375 178.561558 
L 367.764375 178.561558 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_8"><!-- 0.5 --><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><g style="fill:#262626;" transform="translate(7.2 183.880464)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_3"><g id="line2d_17"><path clip-path="url(#pf2198cf947)" d="M 32.964375 142.366751 
L 367.764375 142.366751 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_9"><!-- 1.0 --><g style="fill:#262626;" transform="translate(7.2 147.685658)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_4"><g id="line2d_19"><path clip-path="url(#pf2198cf947)" d="M 32.964375 106.171945 
L 367.764375 106.171945 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_10"><!-- 1.5 --><g style="fill:#262626;" transform="translate(7.2 111.490852)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_5"><g id="line2d_21"><path clip-path="url(#pf2198cf947)" d="M 32.964375 69.977139 
L 367.764375 69.977139 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_22"></g><g id="text_11"><!-- 2.0 --><g style="fill:#262626;" transform="translate(7.2 75.296046)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_6"><g id="line2d_23"><path clip-path="url(#pf2198cf947)" d="M 32.964375 33.782333 
L 367.764375 33.782333 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_24"></g><g id="text_12"><!-- 2.5 --><g style="fill:#262626;" transform="translate(7.2 39.101239)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-53"></use></g></g></g></g><g id="line2d_25"><path clip-path="url(#pf2198cf947)" d="M 48.182557 214.756364 
L 51.226193 214.756364 
L 54.269829 214.75636 
L 57.313466 214.756323 
L 60.357102 214.756143 
L 63.400739 214.755549 
L 66.444375 214.754007 
L 69.488011 214.750609 
L 72.531647 214.743951 
L 75.575285 214.732012 
L 78.618921 214.712035 
L 81.662557 214.680422 
L 84.706192 214.632629 
L 87.749828 214.56309 
L 90.793466 214.465145 
L 93.837104 214.331 
L 96.880738 214.1517 
L 99.924376 213.917127 
L 102.968014 213.616028 
L 106.011647 213.236051 
L 109.055285 212.763829 
L 112.098918 212.185059 
L 115.142556 211.484645 
L 118.186194 210.646803 
L 121.229828 209.65526 
L 124.273466 208.493402 
L 127.317099 207.144499 
L 130.360742 205.591892 
L 133.404375 203.819274 
L 136.448009 201.81085 
L 139.491651 199.551663 
L 142.535285 197.02779 
L 145.578918 194.226659 
L 148.622561 191.137217 
L 151.666194 187.75029 
L 154.709828 184.058761 
L 157.75347 180.057846 
L 160.797104 175.745281 
L 163.840737 171.12157 
L 166.884371 166.190286 
L 169.928013 160.957892 
L 172.971647 155.434408 
L 176.01528 149.633139 
L 179.058923 143.570901 
L 182.102556 137.26802 
L 185.14619 130.748621 
L 188.189832 124.040287 
L 191.233466 117.174127 
L 194.277099 110.184859 
L 197.320742 103.110349 
L 200.364375 95.992001 
L 203.408008 88.873808 
L 206.451642 81.802836 
L 209.495275 74.82829 
L 212.538927 68.001567 
L 215.58256 61.375964 
L 218.626194 55.00583 
L 221.669827 48.946444 
L 224.713461 43.253294 
L 227.757094 37.981835 
L 230.800746 33.186517 
L 233.844379 28.920776 
L 236.888013 25.235421 
L 239.931646 22.179295 
L 242.97528 19.79736 
L 246.018913 18.13069 
L 249.062565 17.215737 
L 252.106198 17.083636 
L 255.149832 17.759431 
L 258.193465 19.261346 
L 261.237099 21.600462 
L 264.280732 24.779782 
L 267.324384 28.794008 
L 270.368017 33.628918 
L 273.411651 39.260711 
L 276.455284 45.656303 
L 279.498918 52.772598 
L 282.542551 60.556471 
L 285.586184 68.944842 
L 288.629836 77.864843 
L 291.67347 87.234131 
L 294.717103 96.961285 
L 297.760736 106.946962 
L 300.80437 117.084052 
L 303.848003 127.259605 
L 306.891655 137.355946 
L 309.935288 147.252152 
L 312.978922 156.826611 
L 316.022555 165.959058 
L 319.066189 174.533374 
L 322.109822 182.440828 
L 325.153474 189.583561 
L 328.197107 195.878509 
L 331.240741 201.262139 
L 334.284374 205.695343 
L 337.328008 209.168987 
L 340.371641 211.710124 
L 343.415293 213.388795 
L 346.458926 214.325439 
L 349.50256 214.699115 
L 352.546193 214.756364 
" style="fill:none;stroke:#2a2eec;stroke-linecap:round;stroke-width:1.5;"></path></g><g id="line2d_26"><path clip-path="url(#pf2198cf947)" d="M 48.182557 214.484549 
L 51.226193 214.421252 
L 54.269829 214.344643 
L 57.313466 214.252268 
L 60.357102 214.141298 
L 63.400739 214.008493 
L 66.444375 213.850152 
L 69.488011 213.662082 
L 72.531647 213.439544 
L 75.575285 213.177223 
L 78.618921 212.869189 
L 81.662557 212.508856 
L 84.706192 212.088969 
L 87.749828 211.601574 
L 90.793466 211.038007 
L 93.837104 210.388904 
L 96.880738 209.644211 
L 99.924376 208.793204 
L 102.968014 207.824566 
L 106.011647 206.726415 
L 109.055285 205.48643 
L 112.098918 204.091924 
L 115.142556 202.530019 
L 118.186194 200.787773 
L 121.229828 198.852387 
L 124.273466 196.711403 
L 127.317099 194.352919 
L 130.360742 191.765862 
L 133.404375 188.940274 
L 136.448009 185.867548 
L 139.491651 182.540745 
L 142.535285 178.954943 
L 145.578918 175.107448 
L 148.622561 170.998138 
L 151.666194 166.629753 
L 154.709828 162.008113 
L 157.75347 157.142322 
L 160.797104 152.045088 
L 163.840737 146.732673 
L 166.884371 141.225101 
L 169.928013 135.546139 
L 172.971647 129.723357 
L 176.01528 123.787847 
L 179.058923 117.774172 
L 182.102556 111.720102 
L 185.14619 105.666239 
L 188.189832 99.655627 
L 191.233466 93.733346 
L 194.277099 87.945911 
L 197.320742 82.340679 
L 200.364375 76.965303 
L 203.408008 71.867003 
L 206.451642 67.091896 
L 209.495275 62.684337 
L 212.538927 58.686145 
L 215.58256 55.136152 
L 218.626194 52.069292 
L 221.669827 49.516285 
L 224.713461 47.50295 
L 227.757094 46.049844 
L 230.800746 45.171911 
L 233.844379 44.878266 
L 236.888013 45.171911 
L 239.931646 46.049826 
L 242.97528 47.502933 
L 246.018913 49.516268 
L 249.062565 52.069292 
L 252.106198 55.136152 
L 255.149832 58.686145 
L 258.193465 62.684302 
L 261.237099 67.091878 
L 264.280732 71.866968 
L 267.324384 76.965303 
L 270.368017 82.340679 
L 273.411651 87.945894 
L 276.455284 93.733338 
L 279.498918 99.655609 
L 282.542551 105.666195 
L 285.586184 111.720059 
L 288.629836 117.774172 
L 291.67347 123.78783 
L 294.717103 129.723348 
L 297.760736 135.54613 
L 300.80437 141.225067 
L 303.848003 146.732638 
L 306.891655 152.045088 
L 309.935288 157.142322 
L 312.978922 162.008091 
L 316.022555 166.629735 
L 319.066189 170.998116 
L 322.109822 175.107422 
L 325.153474 178.954943 
L 328.197107 182.540745 
L 331.240741 185.867535 
L 334.284374 188.940261 
L 337.328008 191.765853 
L 340.371641 194.352911 
L 343.415293 196.711403 
L 346.458926 198.852387 
L 349.50256 200.787773 
L 352.546193 202.530011 
" style="fill:none;stroke:#fa7c17;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 32.964375 224.64 
L 32.964375 7.2 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 367.764375 224.64 
L 367.764375 7.2 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 32.964375 224.64 
L 367.764375 224.64 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 32.964375 7.2 
L 367.764375 7.2 
" style="fill:none;"></path></g></g></g><defs><clippath id="pf2198cf947"><rect height="217.44" width="334.8" x="32.964375" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.8">Code 2.8<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.8">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_samples</span>
<span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">W</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">with</span> <span class="n">npyro</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">):</span>
        <span class="n">p_new</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"p_new"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">0.1</span><span class="p">))</span>
        <span class="n">p_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_new</span><span class="p">)</span> <span class="k">if</span> <span class="n">p_new</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">p_new</span>
        <span class="n">p_new</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">p_new</span> <span class="k">if</span> <span class="n">p_new</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">p_new</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="n">L</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="n">L</span><span class="p">,</span> <span class="n">p_new</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"u"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Uniform</span><span class="p">())</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_new</span> <span class="k">if</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="n">q1</span> <span class="o">/</span> <span class="n">q0</span> <span class="k">else</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-2.9">Code 2.9<a class="anchor-link" href="02-small-worlds-and-large-worlds.html#Code-2.9">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">az</span><span class="o">.</span><span class="n">plot_density</span><span class="p">({</span><span class="s2">"p"</span><span class="p">:</span> <span class="n">p</span><span class="p">},</span> <span class="n">credible_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="s2">"--"</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[9]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="296.39952pt" version="1.1" viewbox="0 0 440.39952 296.39952" width="440.39952pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 296.39952 
L 440.39952 296.39952 
L 440.39952 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 7.2 272.150145 
L 433.19952 272.150145 
L 433.19952 25.3575 
L 7.2 25.3575 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#pa5e0c8f816)" d="M 26.563615 272.150145 
L 26.563615 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 0.0 --><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path></defs><g style="fill:#262626;" transform="translate(15.431427 286.287957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#pa5e0c8f816)" d="M 104.018073 272.150145 
L 104.018073 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 0.2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(92.885885 286.287957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#pa5e0c8f816)" d="M 181.472531 272.150145 
L 181.472531 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.4 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(170.340343 286.287957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#pa5e0c8f816)" d="M 258.926989 272.150145 
L 258.926989 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 0.6 --><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(247.794802 286.287957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-54"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#pa5e0c8f816)" d="M 336.381447 272.150145 
L 336.381447 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 0.8 --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(325.24926 286.287957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#pa5e0c8f816)" d="M 413.835905 272.150145 
L 413.835905 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 1.0 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(402.703718 286.287957)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g></g><g id="matplotlib.axis_2"></g><g id="line2d_13"><path clip-path="url(#pa5e0c8f816)" d="M 118.60294 258.318182 
L 122.80008 258.14961 
L 126.997221 257.575908 
L 129.795315 257.000751 
L 133.992455 255.831871 
L 138.189596 254.361192 
L 143.785783 252.165433 
L 149.381971 249.731731 
L 153.579111 247.773856 
L 156.377205 246.333475 
L 160.574346 243.956814 
L 166.170533 240.419179 
L 175.963861 233.909734 
L 182.959095 228.998524 
L 185.757189 226.806435 
L 188.555283 224.317962 
L 191.353377 221.350486 
L 194.15147 217.908416 
L 196.949564 213.910277 
L 199.747658 209.312035 
L 202.545751 204.271298 
L 212.339079 185.467617 
L 217.935267 175.607097 
L 220.733361 170.663902 
L 223.531454 165.447125 
L 226.329548 159.84419 
L 229.127642 153.675158 
L 231.925735 147.022513 
L 237.521923 132.710858 
L 250.113345 100.527151 
L 252.911438 93.998292 
L 255.709532 88.076467 
L 257.108579 85.385654 
L 258.507626 82.996107 
L 259.906673 80.854745 
L 261.30572 78.956894 
L 262.704766 77.34351 
L 264.103813 75.940931 
L 265.50286 74.735537 
L 268.300954 72.726952 
L 271.099048 70.807411 
L 272.498094 69.714782 
L 275.296188 66.992537 
L 278.094282 63.685709 
L 280.892376 59.822891 
L 289.286657 47.68892 
L 290.685704 45.904135 
L 293.483797 42.7341 
L 296.281891 40.139234 
L 297.680938 39.033408 
L 300.479032 37.354513 
L 301.878078 36.854979 
L 303.277125 36.586278 
L 304.676172 36.575347 
L 306.075219 36.817405 
L 307.474266 37.429314 
L 308.873313 38.398017 
L 310.27236 39.785946 
L 311.671406 41.455667 
L 313.070453 43.548721 
L 314.4695 46.049214 
L 317.267594 51.943557 
L 320.065688 58.929792 
L 322.863781 66.950239 
L 325.661875 75.715339 
L 331.258062 94.33392 
L 334.056156 103.519239 
L 336.85425 111.954451 
L 338.253297 115.783454 
L 341.05139 122.481334 
L 342.450437 125.316509 
L 343.849484 127.806991 
L 345.248531 129.885882 
L 346.647578 131.655248 
L 348.046625 133.230924 
L 353.642812 138.795303 
L 356.440906 142.088199 
L 357.839953 144.078917 
L 359.239 146.36698 
L 360.638047 148.907947 
L 363.43614 154.964772 
L 366.234234 161.939695 
L 369.032328 169.642407 
L 380.224703 201.554806 
L 383.022796 208.512417 
L 385.82089 214.797179 
L 387.219937 217.568791 
L 388.618984 220.057668 
L 390.018031 222.213795 
L 391.417077 224.066334 
L 392.816124 225.55474 
L 394.215171 226.70084 
L 395.614218 227.517275 
L 397.013265 227.904031 
L 397.013265 227.904031 
" style="fill:none;stroke:#2a2eec;stroke-linecap:round;stroke-width:1.5;"></path></g><g id="line2d_14"><path clip-path="url(#pa5e0c8f816)" d="M 118.60294 260.628156 
L 118.60294 258.318182 
" style="fill:none;stroke:#2a2eec;stroke-linecap:round;stroke-width:1.5;"></path></g><g id="line2d_15"><path clip-path="url(#pa5e0c8f816)" d="M 397.013265 260.932297 
L 397.013265 227.904031 
" style="fill:none;stroke:#2a2eec;stroke-linecap:round;stroke-width:1.5;"></path></g><g id="line2d_16"><defs><path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m7c99f5f8c5" style="stroke:#000000;"></path></defs><g clip-path="url(#pa5e0c8f816)"><use style="fill:#2a2eec;stroke:#000000;" x="288.63615" xlink:href="#m7c99f5f8c5" y="260.605285"></use></g></g><g id="line2d_17"><path clip-path="url(#pa5e0c8f816)" d="M 26.563615 260.605285 
L 30.436337 260.605285 
L 34.30906 260.605281 
L 38.181783 260.605243 
L 42.054506 260.605055 
L 45.927229 260.604436 
L 49.799951 260.602829 
L 53.672675 260.599286 
L 57.545397 260.592345 
L 61.418122 260.579899 
L 65.290844 260.559074 
L 69.163566 260.526119 
L 73.036288 260.476297 
L 76.909011 260.403805 
L 80.781736 260.301702 
L 84.65446 260.161862 
L 88.52718 259.974949 
L 92.399905 259.730418 
L 96.27263 259.416535 
L 100.145349 259.020425 
L 104.018074 258.528154 
L 107.890793 257.924811 
L 111.763518 257.19466 
L 115.636243 256.321247 
L 119.508962 255.287606 
L 123.381687 254.076419 
L 127.254406 252.670246 
L 131.127137 251.051721 
L 134.999856 249.203844 
L 138.872576 247.110148 
L 142.745306 244.755045 
L 146.618026 242.124016 
L 150.490745 239.203958 
L 154.363476 235.983349 
L 158.236195 232.452625 
L 162.108914 228.604366 
L 165.981645 224.433586 
L 169.854364 219.937924 
L 173.727083 215.117906 
L 177.599802 209.977256 
L 181.472533 204.522713 
L 185.345252 198.76472 
L 189.217972 192.717149 
L 193.090702 186.397529 
L 196.963422 179.827049 
L 200.836141 173.030858 
L 204.708872 166.03771 
L 208.581591 158.880037 
L 212.45431 151.594029 
L 216.327041 144.219159 
L 220.19976 136.798589 
L 224.072479 129.378182 
L 227.945198 122.007 
L 231.817918 114.736339 
L 235.69066 107.619777 
L 239.563379 100.712873 
L 243.436098 94.072284 
L 247.308818 87.755637 
L 251.181537 81.820776 
L 255.054256 76.325508 
L 258.926998 71.326597 
L 262.799718 66.879747 
L 266.672437 63.037924 
L 270.545156 59.852046 
L 274.417875 57.368982 
L 278.290594 55.631551 
L 282.163337 54.677752 
L 286.036056 54.540043 
L 289.908775 55.244529 
L 293.781494 56.810211 
L 297.654214 59.248638 
L 301.526933 62.562941 
L 305.399675 66.747597 
L 309.272394 71.787781 
L 313.145114 77.658681 
L 317.017833 84.325808 
L 320.890552 91.744237 
L 324.763271 99.858587 
L 328.63599 108.6031 
L 332.508733 117.901814 
L 336.381452 127.66889 
L 340.254171 137.809026 
L 344.12689 148.218661 
L 347.99961 158.786138 
L 351.872329 169.39371 
L 355.745071 179.918708 
L 359.61779 190.235074 
L 363.490509 200.216032 
L 367.363229 209.736211 
L 371.235948 218.674563 
L 375.108667 226.917741 
L 378.981409 234.363731 
L 382.854129 240.925941 
L 386.726848 246.538141 
L 390.599567 251.159565 
L 394.472286 254.780687 
L 398.345006 257.429712 
L 402.217748 259.179654 
L 406.090467 260.156065 
L 409.963186 260.545606 
L 413.835905 260.605285 
" style="fill:none;stroke:#2a2eec;stroke-dasharray:5.55,2.4;stroke-dashoffset:0;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 7.2 272.150145 
L 433.19952 272.150145 
" style="fill:none;"></path></g><g id="text_7"><!-- p --><defs><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path></defs><g style="fill:#262626;" transform="translate(215.12101 19.3575)scale(0.16 -0.16)"><use xlink:href="#DejaVuSans-112"></use></g></g></g></g><defs><clippath id="pa5e0c8f816"><rect height="246.792645" width="425.99952" x="7.2" y="25.3575"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="01-the-golem-of-prague.html">Chapter 1. The Golem of Prague</a> | <a href="03-sampling-the-imaginary.html">Chapter 3. Sampling the Imaginary</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
</div>
    </div>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><!--End of body content--><footer id="footer"><div class="text-center">
  Contents © 2019         <a href="mailto:fehiepsi@gmail.com">Du Phan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>

</div>

            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-131299125-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131299125-1');
</script>
</body>
</html>
