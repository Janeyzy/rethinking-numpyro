<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Chapter 7. Ulysses’ Compass | Statistical Rethinking (2nd ed.) with NumPyro</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://fehiepsi.github.io/rethinking-numpyro/07-ulysses-compass.html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><meta name="author" content="fehiepsi">
<meta property="og:site_name" content="Statistical Rethinking (2nd ed.) with NumPyro">
<meta property="og:title" content="Chapter 7. Ulysses’ Compass">
<meta property="og:url" content="https://fehiepsi.github.io/rethinking-numpyro/07-ulysses-compass.html">
<meta property="og:description" content="&lt; Chapter 6. The Haunted DAG &amp; The Causal Terror | Chapter 8. Conditional Manatees &gt;

    
    
    
    









In [0]:

    
import warnings

import arviz as az
import matplotlib.pyplot as plt
imp">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-10-29T00:46:37-04:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="https://fehiepsi.github.io/rethinking-numpyro/">

            <span id="blog-title">Statistical Rethinking (2nd ed.) with NumPyro</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav"></ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100"></ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Chapter 7. Ulysses’ Compass</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="06-the-haunted-dag-and-the-causal-terror.html">Chapter 6. The Haunted DAG &amp; The Causal Terror</a> | <a href="08-conditional-manatees.html">Chapter 8. Conditional Manatees</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">onp</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">jax</span> <span class="k">import</span> <span class="n">lax</span><span class="p">,</span> <span class="n">ops</span><span class="p">,</span> <span class="n">vmap</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">jax.random</span> <span class="k">import</span> <span class="n">PRNGKey</span><span class="p">,</span> <span class="n">fold_in</span>
<span class="kn">from</span> <span class="nn">jax.scipy.special</span> <span class="k">import</span> <span class="n">logsumexp</span>

<span class="kn">import</span> <span class="nn">numpyro</span> <span class="k">as</span> <span class="nn">npyro</span>
<span class="kn">from</span> <span class="nn">numpyro.contrib.autoguide</span> <span class="k">import</span> <span class="p">(</span><span class="n">AutoContinuousELBO</span><span class="p">,</span>
                                       <span class="n">AutoLaplaceApproximation</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">numpyro.diagnostics</span> <span class="k">import</span> <span class="n">summary</span>
<span class="kn">import</span> <span class="nn">numpyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="kn">from</span> <span class="nn">numpyro.infer</span> <span class="k">import</span> <span class="n">ELBO</span><span class="p">,</span> <span class="n">Predictive</span><span class="p">,</span> <span class="n">SVI</span><span class="p">,</span> <span class="n">init_to_value</span><span class="p">,</span> <span class="n">log_likelihood</span>
<span class="kn">import</span> <span class="nn">numpyro.optim</span> <span class="k">as</span> <span class="nn">optim</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = ["svg"]
<span class="n">warnings</span><span class="o">.</span><span class="n">formatwarning</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span>
                          <span class="s2">"</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">category</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"arviz-darkgrid"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.1">Code 7.1<a class="anchor-link" href="07-ulysses-compass.html#Code-7.1">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sppnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"afarensis"</span><span class="p">,</span> <span class="s2">"africanus"</span><span class="p">,</span> <span class="s2">"habilis"</span><span class="p">,</span> <span class="s2">"boisei"</span><span class="p">,</span>
            <span class="s2">"rudolfensis"</span><span class="p">,</span> <span class="s2">"ergaster"</span><span class="p">,</span> <span class="s2">"sapiens"</span><span class="p">]</span>
<span class="n">brainvolcc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">438</span><span class="p">,</span> <span class="mi">452</span><span class="p">,</span> <span class="mi">612</span><span class="p">,</span> <span class="mi">521</span><span class="p">,</span> <span class="mi">752</span><span class="p">,</span> <span class="mi">871</span><span class="p">,</span> <span class="mi">1350</span><span class="p">])</span>
<span class="n">masskg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">37.0</span><span class="p">,</span> <span class="mf">35.5</span><span class="p">,</span> <span class="mf">34.5</span><span class="p">,</span> <span class="mf">41.5</span><span class="p">,</span> <span class="mf">55.5</span><span class="p">,</span> <span class="mf">61.0</span><span class="p">,</span> <span class="mf">53.5</span><span class="p">])</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">"species"</span><span class="p">:</span> <span class="n">sppnames</span><span class="p">,</span> <span class="s2">"brain"</span><span class="p">:</span> <span class="n">brainvolcc</span><span class="p">,</span> <span class="s2">"mass"</span><span class="p">:</span> <span class="n">masskg</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.2">Code 7.2<a class="anchor-link" href="07-ulysses-compass.html#Code-7.2">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="p">[</span><span class="s2">"mass_std"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">mass</span> <span class="o">-</span> <span class="n">d</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">d</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">d</span><span class="p">[</span><span class="s2">"brain_std"</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">brain</span> <span class="o">/</span> <span class="n">d</span><span class="o">.</span><span class="n">brain</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.3">Code 7.3<a class="anchor-link" href="07-ulysses-compass.html#Code-7.3">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mass_std</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">mass_std</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_1</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_1</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">mass_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p7_1</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.4">Code 7.4<a class="anchor-link" href="07-ulysses-compass.html#Code-7.4">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m7_1</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p7_1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">m7_1</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span><span class="o">.</span><span class="n">get_samples</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">"brain_std"</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span>
<span class="n">resid_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">outcome_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">1</span> <span class="o">-</span> <span class="n">resid_var</span> <span class="o">/</span> <span class="n">outcome_var</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[4]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0.49477673, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.5">Code 7.5<a class="anchor-link" href="07-ulysses-compass.html#Code-7.5">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">R2_is_bad</span><span class="p">(</span><span class="n">quap_fit</span><span class="p">):</span>
    <span class="n">quap</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">quap_fit</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">quap</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">params</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">quap</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span><span class="o">.</span><span class="n">get_samples</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s2">"brain_std"</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.6">Code 7.6<a class="anchor-link" href="07-ulysses-compass.html#Code-7.6">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mass_std</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass_std</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass_std</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_2</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">init_strategy</span><span class="o">=</span><span class="n">init_to_value</span><span class="p">({</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="p">)}))</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_2</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">mass_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="n">p7_2</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.7">Code 7.7<a class="anchor-link" href="07-ulysses-compass.html#Code-7.7">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mass_std</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass_std</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass_std</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">mass_std</span> <span class="o">**</span> <span class="mi">3</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_3</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">init_strategy</span><span class="o">=</span><span class="n">init_to_value</span><span class="p">({</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">3</span><span class="p">)}))</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_3</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">mass_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="n">p7_3</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mass_std</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mass_std</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_4</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">init_strategy</span><span class="o">=</span><span class="n">init_to_value</span><span class="p">({</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">4</span><span class="p">)}))</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_4</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">mass_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="n">p7_4</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mass_std</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mass_std</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_5</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">init_strategy</span><span class="o">=</span><span class="n">init_to_value</span><span class="p">({</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">5</span><span class="p">)}))</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_5</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">mass_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2000</span><span class="p">))</span>
<span class="n">p7_5</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.8">Code 7.8<a class="anchor-link" href="07-ulysses-compass.html#Code-7.8">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mass_std</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">mass_std</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_6</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">init_strategy</span><span class="o">=</span><span class="n">init_to_value</span><span class="p">({</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">6</span><span class="p">)}))</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_6</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.003</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">mass_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">5000</span><span class="p">))</span>
<span class="n">p7_6</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.9">Code 7.9<a class="anchor-link" href="07-ulysses-compass.html#Code-7.9">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m7_1</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p7_1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">mass_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">Predictive</span><span class="p">(</span><span class="n">m7_1</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">return_sites</span><span class="o">=</span><span class="p">[</span><span class="s2">"mu"</span><span class="p">])</span><span class="o">.</span><span class="n">get_samples</span><span class="p">(</span>
    <span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">mass_std</span><span class="o">=</span><span class="n">mass_seq</span><span class="p">)[</span><span class="s2">"mu"</span><span class="p">]</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="p">(</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">95.5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_pair</span><span class="p">(</span><span class="n">d</span><span class="p">[[</span><span class="s2">"mass_std"</span><span class="p">,</span> <span class="s2">"brain_std"</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">"list"</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mass_seq</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="s2">"k"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">mass_seq</span><span class="p">,</span> <span class="n">ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ci</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"m7.1: R^2 = </span><span class="si">{:0.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">R2_is_bad</span><span class="p">((</span><span class="n">m7_1</span><span class="p">,</span> <span class="n">p7_1</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[9]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="296.39952pt" version="1.1" viewbox="0 0 440.399229 296.39952" width="440.399229pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 296.39952 
L 440.399229 296.39952 
L 440.399229 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 51.89875 253.21577 
L 428.102586 253.21577 
L 428.102586 25.3575 
L 51.89875 25.3575 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#p4a70098661)" d="M 70.226368 253.21577 
L 70.226368 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- −1.0 --><defs><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><g style="fill:#262626;" transform="translate(53.2284 267.353582)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-49"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#p4a70098661)" d="M 140.594503 253.21577 
L 140.594503 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- −0.5 --><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><g style="fill:#262626;" transform="translate(123.596534 267.353582)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#p4a70098661)" d="M 210.962637 253.21577 
L 210.962637 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.0 --><g style="fill:#262626;" transform="translate(199.83045 267.353582)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#p4a70098661)" d="M 281.330772 253.21577 
L 281.330772 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 0.5 --><g style="fill:#262626;" transform="translate(270.198584 267.353582)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#p4a70098661)" d="M 351.698907 253.21577 
L 351.698907 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 1.0 --><g style="fill:#262626;" transform="translate(340.566719 267.353582)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#p4a70098661)" d="M 422.067041 253.21577 
L 422.067041 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 1.5 --><g style="fill:#262626;" transform="translate(410.934854 267.353582)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="text_7"><!-- mass_std --><defs><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 50.984375 -16.609375 
L 50.984375 -23.578125 
L -0.984375 -23.578125 
L -0.984375 -16.609375 
z
" id="DejaVuSans-95"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path></defs><g style="fill:#262626;" transform="translate(204.926449 285.662801)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-97"></use><use x="158.691406" xlink:href="#DejaVuSans-115"></use><use x="210.791016" xlink:href="#DejaVuSans-115"></use><use x="262.890625" xlink:href="#DejaVuSans-95"></use><use x="312.890625" xlink:href="#DejaVuSans-115"></use><use x="364.990234" xlink:href="#DejaVuSans-116"></use><use x="404.199219" xlink:href="#DejaVuSans-100"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_13"><path clip-path="url(#p4a70098661)" d="M 51.89875 240.465807 
L 428.102586 240.465807 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_8"><!-- 0.2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(26.134375 245.784713)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="ytick_2"><g id="line2d_15"><path clip-path="url(#p4a70098661)" d="M 51.89875 189.278029 
L 428.102586 189.278029 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_9"><!-- 0.4 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(26.134375 194.596935)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="ytick_3"><g id="line2d_17"><path clip-path="url(#p4a70098661)" d="M 51.89875 138.090251 
L 428.102586 138.090251 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_10"><!-- 0.6 --><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(26.134375 143.409157)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-54"></use></g></g></g><g id="ytick_4"><g id="line2d_19"><path clip-path="url(#p4a70098661)" d="M 51.89875 86.902472 
L 428.102586 86.902472 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_11"><!-- 0.8 --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(26.134375 92.221379)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="ytick_5"><g id="line2d_21"><path clip-path="url(#p4a70098661)" d="M 51.89875 35.714694 
L 428.102586 35.714694 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_22"></g><g id="text_12"><!-- 1.0 --><g style="fill:#262626;" transform="translate(26.134375 41.0336)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="text_13"><!-- brain_std --><defs><path d="M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
M 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
z
" id="DejaVuSans-98"></path><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path></defs><g style="fill:#262626;" transform="translate(18.597656 173.922572)rotate(-90)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-98"></use><use x="63.476562" xlink:href="#DejaVuSans-114"></use><use x="104.589844" xlink:href="#DejaVuSans-97"></use><use x="165.869141" xlink:href="#DejaVuSans-105"></use><use x="193.652344" xlink:href="#DejaVuSans-110"></use><use x="257.03125" xlink:href="#DejaVuSans-95"></use><use x="307.03125" xlink:href="#DejaVuSans-115"></use><use x="359.130859" xlink:href="#DejaVuSans-116"></use><use x="398.339844" xlink:href="#DejaVuSans-100"></use></g></g></g><g id="PolyCollection_1"><defs><path d="M 68.998924 -142.851037 
L 68.998924 -53.540944 
L 72.453508 -55.162623 
L 75.908083 -56.49066 
L 79.362666 -58.153715 
L 82.81725 -59.230588 
L 86.271825 -60.682534 
L 89.726408 -62.294336 
L 93.180991 -63.91076 
L 96.635566 -65.455088 
L 100.09015 -67.035677 
L 103.544733 -68.550044 
L 106.999308 -70.457121 
L 110.453892 -71.999386 
L 113.908475 -73.506411 
L 117.36305 -75.063122 
L 120.817633 -76.577112 
L 124.272217 -78.16084 
L 127.7268 -79.744568 
L 131.181375 -81.351675 
L 134.635959 -82.88587 
L 138.090542 -84.535729 
L 141.545117 -86.051565 
L 144.9997 -86.769647 
L 148.45428 -88.469971 
L 151.908859 -89.68454 
L 155.363442 -90.878225 
L 158.818021 -92.402824 
L 162.272605 -93.974989 
L 165.727184 -95.625107 
L 169.181763 -96.87982 
L 172.636347 -97.708411 
L 176.090926 -99.205353 
L 179.545507 -100.392715 
L 183.000086 -101.634384 
L 186.454668 -103.020703 
L 189.909249 -103.747649 
L 193.363828 -104.776762 
L 196.818409 -105.73898 
L 200.272991 -106.701595 
L 203.727571 -107.790011 
L 207.182152 -108.603408 
L 210.636732 -109.775415 
L 214.091313 -110.967048 
L 217.545894 -112.192372 
L 221.000474 -113.415431 
L 224.455055 -114.228576 
L 227.909636 -114.996947 
L 231.364216 -115.950249 
L 234.818797 -116.431076 
L 238.273379 -116.5696 
L 241.727958 -117.566562 
L 245.182539 -118.758142 
L 248.637118 -119.506117 
L 252.091702 -120.248226 
L 255.546281 -120.777137 
L 259.00086 -121.310968 
L 262.455443 -122.099896 
L 265.910023 -123.308035 
L 269.364606 -124.228126 
L 272.819185 -125.395 
L 276.273764 -126.274322 
L 279.728348 -126.78688 
L 283.182927 -127.464704 
L 286.63751 -128.161559 
L 290.092085 -128.794571 
L 293.546669 -129.56073 
L 297.001252 -130.252467 
L 300.455827 -130.946729 
L 303.910411 -131.610267 
L 307.364994 -132.310036 
L 310.819569 -132.946816 
L 314.274152 -133.626265 
L 317.728736 -134.409358 
L 321.183311 -135.111506 
L 324.637894 -135.784579 
L 328.092478 -136.488222 
L 331.547053 -137.008819 
L 335.001636 -137.350153 
L 338.456219 -137.696094 
L 341.910794 -138.051646 
L 345.365378 -137.96878 
L 348.819961 -138.44622 
L 352.274545 -138.972187 
L 355.729128 -139.805576 
L 359.183695 -140.633519 
L 362.638278 -140.491951 
L 366.092861 -141.049191 
L 369.547445 -141.794466 
L 373.002028 -142.692002 
L 376.456612 -143.5134 
L 379.911178 -143.939904 
L 383.365762 -144.22426 
L 386.820345 -144.396719 
L 390.274928 -144.574609 
L 393.729512 -144.936522 
L 397.184095 -146.055671 
L 400.638662 -147.186336 
L 404.093245 -147.809372 
L 407.547829 -148.040792 
L 411.002412 -148.272213 
L 411.002412 -257.541167 
L 411.002412 -257.541167 
L 407.547829 -255.732685 
L 404.093245 -254.029478 
L 400.638662 -252.335287 
L 397.184095 -250.621692 
L 393.729512 -248.695165 
L 390.274928 -247.058456 
L 386.820345 -245.537411 
L 383.365762 -243.992522 
L 379.911178 -242.032389 
L 376.456612 -240.076877 
L 373.002028 -238.117628 
L 369.547445 -236.15484 
L 366.092861 -234.192082 
L 362.638278 -232.260567 
L 359.183695 -230.596109 
L 355.729128 -229.075155 
L 352.274545 -227.156149 
L 348.819961 -225.416818 
L 345.365378 -223.854188 
L 341.910794 -222.431798 
L 338.456219 -220.877543 
L 335.001636 -219.418617 
L 331.547053 -217.869655 
L 328.092478 -216.186844 
L 324.637894 -214.731702 
L 321.183311 -213.106342 
L 317.728736 -211.684959 
L 314.274152 -209.997404 
L 310.819569 -208.504856 
L 307.364994 -207.017433 
L 303.910411 -205.50963 
L 300.455827 -204.02358 
L 297.001252 -202.422476 
L 293.546669 -200.90465 
L 290.092085 -199.339411 
L 286.63751 -197.885794 
L 283.182927 -196.566377 
L 279.728348 -194.964296 
L 276.273764 -193.654901 
L 272.819185 -192.315057 
L 269.364606 -191.140914 
L 265.910023 -189.947077 
L 262.455443 -188.631961 
L 259.00086 -186.931333 
L 255.546281 -185.636369 
L 252.091702 -184.328881 
L 248.637118 -183.129979 
L 245.182539 -181.559492 
L 241.727958 -180.061513 
L 238.273379 -179.578474 
L 234.818797 -178.460012 
L 231.364216 -177.28889 
L 227.909636 -176.008083 
L 224.455055 -175.037368 
L 221.000474 -173.96278 
L 217.545894 -172.890831 
L 214.091313 -171.653654 
L 210.636732 -170.772715 
L 207.182152 -169.424877 
L 203.727571 -168.670312 
L 200.272991 -167.725057 
L 196.818409 -166.792617 
L 193.363828 -165.357886 
L 189.909249 -163.905001 
L 186.454668 -163.408598 
L 183.000086 -162.156029 
L 179.545507 -162.234211 
L 176.090926 -161.26673 
L 172.636347 -160.284024 
L 169.181763 -159.301348 
L 165.727184 -158.324302 
L 162.272605 -157.413676 
L 158.818021 -156.404472 
L 155.363442 -156.300447 
L 151.908859 -155.476975 
L 148.45428 -154.820012 
L 144.9997 -154.32666 
L 141.545117 -153.255962 
L 138.090542 -152.683437 
L 134.635959 -151.868949 
L 131.181375 -151.226326 
L 127.7268 -150.73421 
L 124.272217 -149.979554 
L 120.817633 -149.636831 
L 117.36305 -149.227963 
L 113.908475 -148.933737 
L 110.453892 -148.752735 
L 106.999308 -148.595073 
L 103.544733 -148.267499 
L 100.09015 -147.530874 
L 96.635566 -147.277715 
L 93.180991 -146.935984 
L 89.726408 -146.277343 
L 86.271825 -145.60961 
L 82.81725 -144.935058 
L 79.362666 -144.336385 
L 75.908083 -144.22429 
L 72.453508 -143.625816 
L 68.998924 -142.851037 
z
" id="m7eaf98036b" style="stroke:#000000;stroke-opacity:0.2;"></path></defs><g clip-path="url(#p4a70098661)"><use style="fill-opacity:0.2;stroke:#000000;stroke-opacity:0.2;" x="0" xlink:href="#m7eaf98036b" y="296.39952"></use></g></g><g id="line2d_23"><path clip-path="url(#p4a70098661)" d="M 101.263404 208.615634 
L 81.90472 205.961453 
L 68.998924 175.627955 
L 159.339469 192.880132 
L 340.020555 149.086144 
L 411.002412 126.525604 
L 314.208973 35.714694 
" style="fill:none;"></path><defs><path d="M 0 1.5 
C 0.397805 1.5 0.77937 1.341951 1.06066 1.06066 
C 1.341951 0.77937 1.5 0.397805 1.5 0 
C 1.5 -0.397805 1.341951 -0.77937 1.06066 -1.06066 
C 0.77937 -1.341951 0.397805 -1.5 0 -1.5 
C -0.397805 -1.5 -0.77937 -1.341951 -1.06066 -1.06066 
C -1.341951 -0.77937 -1.5 -0.397805 -1.5 0 
C -1.5 0.397805 -1.341951 0.77937 -1.06066 1.06066 
C -0.77937 1.341951 -0.397805 1.5 0 1.5 
z
" id="m1f0c1fb0c0" style="stroke:#2a2eec;"></path></defs><g clip-path="url(#p4a70098661)"><use style="fill:#2a2eec;stroke:#2a2eec;" x="101.263404" xlink:href="#m1f0c1fb0c0" y="208.615634"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="81.90472" xlink:href="#m1f0c1fb0c0" y="205.961453"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="68.998924" xlink:href="#m1f0c1fb0c0" y="175.627955"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="159.339469" xlink:href="#m1f0c1fb0c0" y="192.880132"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="340.020555" xlink:href="#m1f0c1fb0c0" y="149.086144"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="411.002412" xlink:href="#m1f0c1fb0c0" y="126.525604"></use><use style="fill:#2a2eec;stroke:#2a2eec;" x="314.208973" xlink:href="#m1f0c1fb0c0" y="35.714694"></use></g></g><g id="line2d_24"><path clip-path="url(#p4a70098661)" d="M 68.998924 198.119994 
L 72.453508 197.07581 
L 75.908083 196.031656 
L 79.362666 194.987472 
L 82.81725 193.94328 
L 86.271825 192.899111 
L 89.726408 191.854927 
L 93.180991 190.810742 
L 96.635566 189.766581 
L 100.09015 188.722412 
L 103.544733 187.67822 
L 106.999308 186.634051 
L 110.453892 185.589867 
L 113.908475 184.54569 
L 117.36305 183.501513 
L 120.817633 182.457344 
L 124.272217 181.413175 
L 127.7268 180.368976 
L 131.181375 179.324807 
L 134.635959 178.280615 
L 138.090542 177.236446 
L 141.545117 176.192269 
L 144.9997 175.1481 
L 148.45428 174.103939 
L 151.908859 173.059739 
L 155.363442 172.01557 
L 158.818021 170.971386 
L 162.272605 169.927224 
L 165.727184 168.883033 
L 169.181763 167.838864 
L 172.636347 166.79471 
L 176.090926 165.75051 
L 179.545507 164.706334 
L 183.000086 163.662157 
L 186.454668 162.617973 
L 189.909249 161.573773 
L 193.363828 160.529619 
L 196.818409 159.48542 
L 200.272991 158.441281 
L 203.727571 157.397067 
L 207.182152 156.352882 
L 210.636732 155.308744 
L 214.091313 154.264544 
L 217.545894 153.220375 
L 221.000474 152.176206 
L 224.455055 151.132007 
L 227.909636 150.087868 
L 231.364216 149.043669 
L 234.818797 147.999469 
L 238.273379 146.9553 
L 241.727958 145.911161 
L 245.182539 144.866962 
L 248.637118 143.822793 
L 252.091702 142.778609 
L 255.546281 141.73444 
L 259.00086 140.690271 
L 262.455443 139.646056 
L 265.910023 138.601917 
L 269.364606 137.557718 
L 272.819185 136.513549 
L 276.273764 135.46938 
L 279.728348 134.42518 
L 283.182927 133.381042 
L 286.63751 132.336842 
L 290.092085 131.292658 
L 293.546669 130.248504 
L 297.001252 129.20432 
L 300.455827 128.16012 
L 303.910411 127.115951 
L 307.364994 126.071782 
L 310.819569 125.027598 
L 314.274152 123.983429 
L 317.728736 122.939245 
L 321.183311 121.895076 
L 324.637894 120.850876 
L 328.092478 119.806692 
L 331.547053 118.762507 
L 335.001636 117.718323 
L 338.456219 116.674139 
L 341.910794 115.63 
L 345.365378 114.585816 
L 348.819961 113.541632 
L 352.274545 112.497478 
L 355.729128 111.453294 
L 359.183695 110.409094 
L 362.638278 109.36491 
L 366.092861 108.320756 
L 369.547445 107.276557 
L 373.002028 106.232388 
L 376.456612 105.188234 
L 379.911178 104.144065 
L 383.365762 103.099881 
L 386.820345 102.055666 
L 390.274928 101.011527 
L 393.729512 99.967358 
L 397.184095 98.923159 
L 400.638662 97.87902 
L 404.093245 96.834775 
L 407.547829 95.790621 
L 411.002412 94.746452 
" style="fill:none;stroke:#000000;stroke-linecap:round;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 51.89875 253.21577 
L 51.89875 25.3575 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 428.102586 253.21577 
L 428.102586 25.3575 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 51.89875 253.21577 
L 428.102586 253.21577 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 51.89875 25.3575 
L 428.102586 25.3575 
" style="fill:none;"></path></g><g id="text_14"><!-- m7.1: R^2 = 0.49 --><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path><path d="M 11.71875 12.40625 
L 22.015625 12.40625 
L 22.015625 0 
L 11.71875 0 
z
M 11.71875 51.703125 
L 22.015625 51.703125 
L 22.015625 39.3125 
L 11.71875 39.3125 
z
" id="DejaVuSans-58"></path><path id="DejaVuSans-32"></path><path d="M 44.390625 34.1875 
Q 47.5625 33.109375 50.5625 29.59375 
Q 53.5625 26.078125 56.59375 19.921875 
L 66.609375 0 
L 56 0 
L 46.6875 18.703125 
Q 43.0625 26.03125 39.671875 28.421875 
Q 36.28125 30.8125 30.421875 30.8125 
L 19.671875 30.8125 
L 19.671875 0 
L 9.8125 0 
L 9.8125 72.90625 
L 32.078125 72.90625 
Q 44.578125 72.90625 50.734375 67.671875 
Q 56.890625 62.453125 56.890625 51.90625 
Q 56.890625 45.015625 53.6875 40.46875 
Q 50.484375 35.9375 44.390625 34.1875 
z
M 19.671875 64.796875 
L 19.671875 38.921875 
L 32.078125 38.921875 
Q 39.203125 38.921875 42.84375 42.21875 
Q 46.484375 45.515625 46.484375 51.90625 
Q 46.484375 58.296875 42.84375 61.546875 
Q 39.203125 64.796875 32.078125 64.796875 
z
" id="DejaVuSans-82"></path><path d="M 46.6875 72.90625 
L 73.1875 45.703125 
L 63.375 45.703125 
L 41.890625 64.984375 
L 20.40625 45.703125 
L 10.59375 45.703125 
L 37.109375 72.90625 
z
" id="DejaVuSans-94"></path><path d="M 10.59375 45.40625 
L 73.1875 45.40625 
L 73.1875 37.203125 
L 10.59375 37.203125 
z
M 10.59375 25.484375 
L 73.1875 25.484375 
L 73.1875 17.1875 
L 10.59375 17.1875 
z
" id="DejaVuSans-61"></path><path d="M 10.984375 1.515625 
L 10.984375 10.5 
Q 14.703125 8.734375 18.5 7.8125 
Q 22.3125 6.890625 25.984375 6.890625 
Q 35.75 6.890625 40.890625 13.453125 
Q 46.046875 20.015625 46.78125 33.40625 
Q 43.953125 29.203125 39.59375 26.953125 
Q 35.25 24.703125 29.984375 24.703125 
Q 19.046875 24.703125 12.671875 31.3125 
Q 6.296875 37.9375 6.296875 49.421875 
Q 6.296875 60.640625 12.9375 67.421875 
Q 19.578125 74.21875 30.609375 74.21875 
Q 43.265625 74.21875 49.921875 64.515625 
Q 56.59375 54.828125 56.59375 36.375 
Q 56.59375 19.140625 48.40625 8.859375 
Q 40.234375 -1.421875 26.421875 -1.421875 
Q 22.703125 -1.421875 18.890625 -0.6875 
Q 15.09375 0.046875 10.984375 1.515625 
z
M 30.609375 32.421875 
Q 37.25 32.421875 41.125 36.953125 
Q 45.015625 41.5 45.015625 49.421875 
Q 45.015625 57.28125 41.125 61.84375 
Q 37.25 66.40625 30.609375 66.40625 
Q 23.96875 66.40625 20.09375 61.84375 
Q 16.21875 57.28125 16.21875 49.421875 
Q 16.21875 41.5 20.09375 36.953125 
Q 23.96875 32.421875 30.609375 32.421875 
z
" id="DejaVuSans-57"></path></defs><g style="fill:#262626;" transform="translate(167.294418 19.3575)scale(0.16 -0.16)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-49"></use><use x="256.445312" xlink:href="#DejaVuSans-58"></use><use x="290.136719" xlink:href="#DejaVuSans-32"></use><use x="321.923828" xlink:href="#DejaVuSans-82"></use><use x="391.40625" xlink:href="#DejaVuSans-94"></use><use x="475.195312" xlink:href="#DejaVuSans-50"></use><use x="538.818359" xlink:href="#DejaVuSans-32"></use><use x="570.605469" xlink:href="#DejaVuSans-61"></use><use x="654.394531" xlink:href="#DejaVuSans-32"></use><use x="686.181641" xlink:href="#DejaVuSans-48"></use><use x="749.804688" xlink:href="#DejaVuSans-46"></use><use x="781.591797" xlink:href="#DejaVuSans-52"></use><use x="845.214844" xlink:href="#DejaVuSans-57"></use></g></g></g></g><defs><clippath id="p4a70098661"><rect height="227.85827" width="376.203836" x="51.89875" y="25.3575"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.10">Code 7.10<a class="anchor-link" href="07-ulysses-compass.html#Code-7.10">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mass_std</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">mass_std</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_1_OLS</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_1_OLS</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">mass_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p7_1_OLS</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m7_1_OLS</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p7_1_OLS</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.11">Code 7.11<a class="anchor-link" href="07-ulysses-compass.html#Code-7.11">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">brain_std</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"mu"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Delta</span><span class="p">(</span><span class="n">mu</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"brain_std"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)),</span>
                 <span class="n">obs</span><span class="o">=</span><span class="n">brain_std</span><span class="p">)</span>

<span class="n">m7_7</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_7</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">brain_std</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p7_7</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m7_7</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p7_7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.12">Code 7.12<a class="anchor-link" href="07-ulysses-compass.html#Code-7.12">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">d_minus_i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.13">Code 7.13<a class="anchor-link" href="07-ulysses-compass.html#Code-7.13">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[13]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0.61086434, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.14">Code 7.14<a class="anchor-link" href="07-ulysses-compass.html#Code-7.14">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">lppd_fn</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">quad</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">quad</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">params</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),))</span>
    <span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span>
        <span class="n">quad</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="s2">"brain_std"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">logprob</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logprob</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">lppd_fn</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m7_1</span><span class="p">,</span> <span class="n">p7_1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[14]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([ 0.61774921,  0.65501213,  0.54551029,  0.63082504,
              0.47028065,  0.43735504, -0.85622978], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.15">Code 7.15<a class="anchor-link" href="07-ulysses-compass.html#Code-7.15">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m7_1</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p7_1</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">),))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span>
    <span class="n">m7_1</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">mass_std</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">brain_std</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="s2">"brain_std"</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">logprob</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ns</span> <span class="o">=</span> <span class="n">logprob</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">logprob</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
<span class="n">lppd</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">f</span><span class="p">)(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">lppd</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[15]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([ 0.61774921,  0.65501213,  0.54551029,  0.63082504,
              0.47028065,  0.43735504, -0.85622978], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.16">Code 7.16<a class="anchor-link" href="07-ulysses-compass.html#Code-7.16">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lppd_fn</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
 <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">((</span><span class="n">m7_1</span><span class="p">,</span> <span class="n">p7_1</span><span class="p">),</span> <span class="p">(</span><span class="n">m7_2</span><span class="p">,</span> <span class="n">p7_2</span><span class="p">),</span> <span class="p">(</span><span class="n">m7_3</span><span class="p">,</span> <span class="n">p7_3</span><span class="p">),</span>
           <span class="p">(</span><span class="n">m7_4</span><span class="p">,</span> <span class="n">p7_4</span><span class="p">),</span> <span class="p">(</span><span class="n">m7_5</span><span class="p">,</span> <span class="n">p7_5</span><span class="p">),</span> <span class="p">(</span><span class="n">m7_6</span><span class="p">,</span> <span class="n">p7_6</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[16]:</span>
</div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>UserWarning: Hessian of log posterior at the MAP point is singular. Posterior samples from AutoLaplaceApproxmiation will be constant (equal to the MAP point).
</pre>
</div>
</div>

<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[16]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>[2.500502586364746,
 2.591395378112793,
 3.669788360595703,
 5.3407697677612305,
 14.086675643920898,
 18.858200073242188]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.17">Code 7.17<a class="anchor-link" href="07-ulysses-compass.html#Code-7.17">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">mm</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">b_sigma</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">]))</span>
    <span class="n">Bvec</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">b_sigma</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,))</span>
        <span class="n">Bvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">Bvec</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mm</span><span class="p">,</span> <span class="n">Bvec</span><span class="p">)</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sim_train_test</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span> <span class="n">b_sigma</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">n_dim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">Rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">n_dim</span><span class="p">)</span>
    <span class="n">Rho</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">index_update</span><span class="p">(</span><span class="n">Rho</span><span class="p">,</span> <span class="n">ops</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span>
    <span class="n">Rho</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">index_update</span><span class="p">(</span><span class="n">Rho</span><span class="p">,</span> <span class="n">ops</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho</span><span class="p">))</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_dim</span><span class="p">),</span> <span class="n">Rho</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">fold_in</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">N</span><span class="p">,))</span>
    <span class="n">mm_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">mm_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">mm_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">init_strategy</span><span class="o">=</span><span class="n">init_to_value</span><span class="p">({</span><span class="s2">"b"</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)}))</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">AutoContinuousELBO</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">mm</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">b_sigma</span><span class="p">:</span> <span class="kc">None</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">ELBO</span><span class="p">()</span>
    <span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">loss</span><span class="p">,</span>
              <span class="n">mm</span><span class="o">=</span><span class="n">mm_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">b_sigma</span><span class="o">=</span><span class="n">b_sigma</span><span class="p">)</span>
    <span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">fold_in</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">coefs</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">"a"</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">coefs</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">params</span><span class="p">)[</span><span class="s2">"b"</span><span class="p">]])</span>

    <span class="n">logprob</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mm_train</span><span class="p">,</span> <span class="n">coefs</span><span class="p">))</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">dev_train</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">logprob</span><span class="p">)</span>

    <span class="n">X_test</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_dim</span><span class="p">),</span> <span class="n">Rho</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">fold_in</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">N</span><span class="p">,))</span>
    <span class="n">mm_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">mm_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">mm_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">k</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">logprob</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mm_test</span><span class="p">,</span> <span class="n">coefs</span><span class="p">))</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">dev_test</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">logprob</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">dev_train</span><span class="p">,</span> <span class="n">dev_test</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">dev_fn</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">sim_train_test</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">kseq</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">dev_fn</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kseq</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[17]:</span>
</div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1
2
3
4
5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.18">Code 7.18<a class="anchor-link" href="07-ulysses-compass.html#Code-7.18">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">dev_fn</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">sim_train_test</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">k</span><span class="p">))(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.19">Code 7.19<a class="anchor-link" href="07-ulysses-compass.html#Code-7.19">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">+</span> <span class="mi">12</span><span class="p">),</span>
            <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">"number of parameters"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"deviance"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"N = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"b"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dev</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">)</span>
<span class="n">pts_int</span> <span class="o">=</span> <span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dev</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">dev</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">pts_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">dev</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dev</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">dev</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dev</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">pts_int</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts_int</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"b"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">pts_out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts_out</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">"in"</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s2">"offset pixels"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"b"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">"out"</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">dev</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s2">"offset pixels"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">"+1SD"</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">pts_out</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s2">"offset pixels"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">"-1SD"</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">pts_out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s2">"offset pixels"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[19]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="285.564063pt" version="1.1" viewbox="0 0 389.032187 285.564063" width="389.032187pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 285.564063 
L 389.032187 285.564063 
L 389.032187 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 47.032187 242.7975 
L 381.832188 242.7975 
L 381.832188 25.3575 
L 47.032187 25.3575 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#ped34744b17)" d="M 54.818234 242.7975 
L 54.818234 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 1 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(50.364484 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#ped34744b17)" d="M 132.678699 242.7975 
L 132.678699 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(128.224949 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#ped34744b17)" d="M 210.539164 242.7975 
L 210.539164 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 3 --><defs><path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path></defs><g style="fill:#262626;" transform="translate(206.085414 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-51"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#ped34744b17)" d="M 288.399629 242.7975 
L 288.399629 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 4 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(283.945879 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-52"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#ped34744b17)" d="M 366.260094 242.7975 
L 366.260094 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 5 --><defs><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><g style="fill:#262626;" transform="translate(361.806344 256.935313)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-53"></use></g></g></g><g id="text_6"><!-- number of parameters --><defs><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
" id="DejaVuSans-117"></path><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
M 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
z
" id="DejaVuSans-98"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path id="DejaVuSans-32"></path><path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path><path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path></defs><g style="fill:#262626;" transform="translate(129.662266 275.244531)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-110"></use><use x="63.378906" xlink:href="#DejaVuSans-117"></use><use x="126.757812" xlink:href="#DejaVuSans-109"></use><use x="224.169922" xlink:href="#DejaVuSans-98"></use><use x="287.646484" xlink:href="#DejaVuSans-101"></use><use x="349.169922" xlink:href="#DejaVuSans-114"></use><use x="390.283203" xlink:href="#DejaVuSans-32"></use><use x="422.070312" xlink:href="#DejaVuSans-111"></use><use x="483.251953" xlink:href="#DejaVuSans-102"></use><use x="518.457031" xlink:href="#DejaVuSans-32"></use><use x="550.244141" xlink:href="#DejaVuSans-112"></use><use x="613.720703" xlink:href="#DejaVuSans-97"></use><use x="675" xlink:href="#DejaVuSans-114"></use><use x="716.113281" xlink:href="#DejaVuSans-97"></use><use x="777.392578" xlink:href="#DejaVuSans-109"></use><use x="874.804688" xlink:href="#DejaVuSans-101"></use><use x="936.328125" xlink:href="#DejaVuSans-116"></use><use x="975.537109" xlink:href="#DejaVuSans-101"></use><use x="1037.060547" xlink:href="#DejaVuSans-114"></use><use x="1078.173828" xlink:href="#DejaVuSans-115"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_11"><path clip-path="url(#ped34744b17)" d="M 47.032187 233.660408 
L 381.832188 233.660408 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_7"><!-- 45 --><g style="fill:#262626;" transform="translate(25.717187 238.979315)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_2"><g id="line2d_13"><path clip-path="url(#ped34744b17)" d="M 47.032187 187.938498 
L 381.832188 187.938498 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_8"><!-- 50 --><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><g style="fill:#262626;" transform="translate(25.717187 193.257404)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_3"><g id="line2d_15"><path clip-path="url(#ped34744b17)" d="M 47.032187 142.216587 
L 381.832188 142.216587 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_9"><!-- 55 --><g style="fill:#262626;" transform="translate(25.717187 147.535494)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-53"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="ytick_4"><g id="line2d_17"><path clip-path="url(#ped34744b17)" d="M 47.032187 96.494677 
L 381.832188 96.494677 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_10"><!-- 60 --><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(25.717187 101.813583)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_5"><g id="line2d_19"><path clip-path="url(#ped34744b17)" d="M 47.032187 50.772767 
L 381.832188 50.772767 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_11"><!-- 65 --><g style="fill:#262626;" transform="translate(25.717187 56.091673)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-54"></use><use x="63.623047" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="text_12"><!-- deviance --><defs><path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path></defs><g style="fill:#262626;" transform="translate(18.597656 168.064219)rotate(-90)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-100"></use><use x="63.476562" xlink:href="#DejaVuSans-101"></use><use x="125" xlink:href="#DejaVuSans-118"></use><use x="184.179688" xlink:href="#DejaVuSans-105"></use><use x="211.962891" xlink:href="#DejaVuSans-97"></use><use x="273.242188" xlink:href="#DejaVuSans-110"></use><use x="336.621094" xlink:href="#DejaVuSans-99"></use><use x="391.601562" xlink:href="#DejaVuSans-101"></use></g></g></g><g id="PathCollection_1"><defs><path d="M 0 4.472136 
C 1.186024 4.472136 2.323632 4.000923 3.162278 3.162278 
C 4.000923 2.323632 4.472136 1.186024 4.472136 0 
C 4.472136 -1.186024 4.000923 -2.323632 3.162278 -3.162278 
C 2.323632 -4.000923 1.186024 -4.472136 0 -4.472136 
C -1.186024 -4.472136 -2.323632 -4.000923 -3.162278 -3.162278 
C -4.000923 -2.323632 -4.472136 -1.186024 -4.472136 0 
C -4.472136 1.186024 -4.000923 2.323632 -3.162278 3.162278 
C -2.323632 4.000923 -1.186024 4.472136 0 4.472136 
z
" id="mc6551fd5b2" style="stroke:#0000ff;"></path></defs><g clip-path="url(#ped34744b17)"><use style="fill:#0000ff;stroke:#0000ff;" x="54.818234" xlink:href="#mc6551fd5b2" y="135.090085"></use><use style="fill:#0000ff;stroke:#0000ff;" x="132.678699" xlink:href="#mc6551fd5b2" y="148.066475"></use><use style="fill:#0000ff;stroke:#0000ff;" x="210.539164" xlink:href="#mc6551fd5b2" y="181.994147"></use><use style="fill:#0000ff;stroke:#0000ff;" x="288.399629" xlink:href="#mc6551fd5b2" y="188.887456"></use><use style="fill:#0000ff;stroke:#0000ff;" x="366.260094" xlink:href="#mc6551fd5b2" y="197.07559"></use></g></g><g id="PathCollection_2"><defs><path d="M 0 4.472136 
C 1.186024 4.472136 2.323632 4.000923 3.162278 3.162278 
C 4.000923 2.323632 4.472136 1.186024 4.472136 0 
C 4.472136 -1.186024 4.000923 -2.323632 3.162278 -3.162278 
C 2.323632 -4.000923 1.186024 -4.472136 0 -4.472136 
C -1.186024 -4.472136 -2.323632 -4.000923 -3.162278 -3.162278 
C -4.000923 -2.323632 -4.472136 -1.186024 -4.472136 0 
C -4.472136 1.186024 -4.000923 2.323632 -3.162278 3.162278 
C -2.323632 4.000923 -1.186024 4.472136 0 4.472136 
z
" id="m0d7616e851" style="stroke:#000000;"></path></defs><g clip-path="url(#ped34744b17)"><use style="stroke:#000000;" x="62.604281" xlink:href="#m0d7616e851" y="117.36824"></use><use style="stroke:#000000;" x="140.464746" xlink:href="#m0d7616e851" y="109.966301"></use><use style="stroke:#000000;" x="218.325211" xlink:href="#m0d7616e851" y="131.774626"></use><use style="stroke:#000000;" x="296.185676" xlink:href="#m0d7616e851" y="119.709137"></use><use style="stroke:#000000;" x="374.046141" xlink:href="#m0d7616e851" y="108.586886"></use></g></g><g id="LineCollection_1"><path clip-path="url(#ped34744b17)" d="M 54.818234 192.485957 
L 54.818234 77.694213 
" style="fill:none;stroke:#0000ff;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 132.678699 202.678819 
L 132.678699 93.454131 
" style="fill:none;stroke:#0000ff;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 210.539164 225.796199 
L 210.539164 138.192095 
" style="fill:none;stroke:#0000ff;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 288.399629 231.838397 
L 288.399629 145.936516 
" style="fill:none;stroke:#0000ff;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 366.260094 237.89678 
L 366.260094 156.254399 
" style="fill:none;stroke:#0000ff;stroke-width:1.5;"></path></g><g id="LineCollection_2"><path clip-path="url(#ped34744b17)" d="M 62.604281 179.082075 
L 62.604281 55.65444 
" style="fill:none;stroke:#000000;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 140.464746 176.107458 
L 140.464746 43.825179 
" style="fill:none;stroke:#000000;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 218.325211 193.511867 
L 218.325211 70.037384 
" style="fill:none;stroke:#000000;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 296.185676 188.401989 
L 296.185676 51.01625 
" style="fill:none;stroke:#000000;stroke-width:1.5;"></path><path clip-path="url(#ped34744b17)" d="M 374.046141 185.059984 
L 374.046141 32.113823 
" style="fill:none;stroke:#000000;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 47.032187 242.7975 
L 47.032187 25.3575 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 381.832188 242.7975 
L 381.832188 25.3575 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 47.032187 242.7975 
L 381.832187 242.7975 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 47.032187 25.3575 
L 381.832187 25.3575 
" style="fill:none;"></path></g><g id="text_13"><!-- in --><g style="fill:#0000ff;" transform="translate(107.678699 153.066475)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-105"></use><use x="27.783203" xlink:href="#DejaVuSans-110"></use></g></g><g id="text_14"><!-- out --><g style="fill:#262626;" transform="translate(150.464746 114.966301)scale(0.1 -0.1)"><use xlink:href="#DejaVuSans-111"></use><use x="61.181641" xlink:href="#DejaVuSans-117"></use><use x="124.560547" xlink:href="#DejaVuSans-116"></use></g></g><g id="text_15"><!-- +1SD --><defs><path d="M 46 62.703125 
L 46 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 46 27.203125 
L 46 0 
L 37.796875 0 
L 37.796875 27.203125 
L 10.59375 27.203125 
L 10.59375 35.5 
L 37.796875 35.5 
L 37.796875 62.703125 
z
" id="DejaVuSans-43"></path><path d="M 53.515625 70.515625 
L 53.515625 60.890625 
Q 47.90625 63.578125 42.921875 64.890625 
Q 37.9375 66.21875 33.296875 66.21875 
Q 25.25 66.21875 20.875 63.09375 
Q 16.5 59.96875 16.5 54.203125 
Q 16.5 49.359375 19.40625 46.890625 
Q 22.3125 44.4375 30.421875 42.921875 
L 36.375 41.703125 
Q 47.40625 39.59375 52.65625 34.296875 
Q 57.90625 29 57.90625 20.125 
Q 57.90625 9.515625 50.796875 4.046875 
Q 43.703125 -1.421875 29.984375 -1.421875 
Q 24.8125 -1.421875 18.96875 -0.25 
Q 13.140625 0.921875 6.890625 3.21875 
L 6.890625 13.375 
Q 12.890625 10.015625 18.65625 8.296875 
Q 24.421875 6.59375 29.984375 6.59375 
Q 38.421875 6.59375 43.015625 9.90625 
Q 47.609375 13.234375 47.609375 19.390625 
Q 47.609375 24.75 44.3125 27.78125 
Q 41.015625 30.8125 33.5 32.328125 
L 27.484375 33.5 
Q 16.453125 35.6875 11.515625 40.375 
Q 6.59375 45.0625 6.59375 53.421875 
Q 6.59375 63.09375 13.40625 68.65625 
Q 20.21875 74.21875 32.171875 74.21875 
Q 37.3125 74.21875 42.625 73.28125 
Q 47.953125 72.359375 53.515625 70.515625 
z
" id="DejaVuSans-83"></path><path d="M 19.671875 64.796875 
L 19.671875 8.109375 
L 31.59375 8.109375 
Q 46.6875 8.109375 53.6875 14.9375 
Q 60.6875 21.78125 60.6875 36.53125 
Q 60.6875 51.171875 53.6875 57.984375 
Q 46.6875 64.796875 31.59375 64.796875 
z
M 9.8125 72.90625 
L 30.078125 72.90625 
Q 51.265625 72.90625 61.171875 64.09375 
Q 71.09375 55.28125 71.09375 36.53125 
Q 71.09375 17.671875 61.125 8.828125 
Q 51.171875 0 30.078125 0 
L 9.8125 0 
z
" id="DejaVuSans-68"></path></defs><g style="fill:#262626;" transform="translate(150.464746 48.825179)scale(0.12 -0.12)"><use xlink:href="#DejaVuSans-43"></use><use x="83.789062" xlink:href="#DejaVuSans-49"></use><use x="147.412109" xlink:href="#DejaVuSans-83"></use><use x="210.888672" xlink:href="#DejaVuSans-68"></use></g></g><g id="text_16"><!-- -1SD --><defs><path d="M 4.890625 31.390625 
L 31.203125 31.390625 
L 31.203125 23.390625 
L 4.890625 23.390625 
z
" id="DejaVuSans-45"></path></defs><g style="fill:#262626;" transform="translate(150.464746 181.107458)scale(0.12 -0.12)"><use xlink:href="#DejaVuSans-45"></use><use x="36.083984" xlink:href="#DejaVuSans-49"></use><use x="99.707031" xlink:href="#DejaVuSans-83"></use><use x="163.183594" xlink:href="#DejaVuSans-68"></use></g></g><g id="text_17"><!-- N = 20 --><defs><path d="M 9.8125 72.90625 
L 23.09375 72.90625 
L 55.421875 11.921875 
L 55.421875 72.90625 
L 64.984375 72.90625 
L 64.984375 0 
L 51.703125 0 
L 19.390625 60.984375 
L 19.390625 0 
L 9.8125 0 
z
" id="DejaVuSans-78"></path><path d="M 10.59375 45.40625 
L 73.1875 45.40625 
L 73.1875 37.203125 
L 10.59375 37.203125 
z
M 10.59375 25.484375 
L 73.1875 25.484375 
L 73.1875 17.1875 
L 10.59375 17.1875 
z
" id="DejaVuSans-61"></path></defs><g style="fill:#262626;" transform="translate(186.478437 19.3575)scale(0.16 -0.16)"><use xlink:href="#DejaVuSans-78"></use><use x="74.804688" xlink:href="#DejaVuSans-32"></use><use x="106.591797" xlink:href="#DejaVuSans-61"></use><use x="190.380859" xlink:href="#DejaVuSans-32"></use><use x="222.167969" xlink:href="#DejaVuSans-50"></use><use x="285.791016" xlink:href="#DejaVuSans-48"></use></g></g></g></g><defs><clippath id="ped34744b17"><rect height="217.44" width="334.8" x="47.032187" y="25.3575"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.20">Code 7.20<a class="anchor-link" href="07-ulysses-compass.html#Code-7.20">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cars</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"../data/cars.csv"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">cars_dist</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">speed</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"dist"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">cars_dist</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">speed</span><span class="o">=</span><span class="n">cars</span><span class="o">.</span><span class="n">speed</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">cars_dist</span><span class="o">=</span><span class="n">cars</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">94</span><span class="p">),</span> <span class="n">params</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.21">Code 7.21<a class="anchor-link" href="07-ulysses-compass.html#Code-7.21">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="k">def</span> <span class="nf">logprob_fn</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">post</span><span class="p">[</span><span class="s2">"a"</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">post</span><span class="p">[</span><span class="s2">"b"</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">cars</span><span class="o">.</span><span class="n">speed</span><span class="o">.</span><span class="n">values</span>
    <span class="k">return</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">post</span><span class="p">[</span><span class="s2">"sigma"</span><span class="p">][</span><span class="n">s</span><span class="p">])</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">cars</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">logprob</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="n">logprob_fn</span><span class="p">,</span> <span class="n">out_axes</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_samples</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.22">Code 7.22<a class="anchor-link" href="07-ulysses-compass.html#Code-7.22">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_cases</span> <span class="o">=</span> <span class="n">cars</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">lppd</span> <span class="o">=</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">logprob</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.23">Code 7.23<a class="anchor-link" href="07-ulysses-compass.html#Code-7.23">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pWAIC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">logprob</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.24">Code 7.24<a class="anchor-link" href="07-ulysses-compass.html#Code-7.24">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">lppd</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pWAIC</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[24]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(422.6037, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.25">Code 7.25<a class="anchor-link" href="07-ulysses-compass.html#Code-7.25">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">waic_vec</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">lppd</span> <span class="o">-</span> <span class="n">pWAIC</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_cases</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">waic_vec</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[25]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(17.004902, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.26">Code 7.26<a class="anchor-link" href="07-ulysses-compass.html#Code-7.26">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">npyro</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="mi">71</span><span class="p">):</span>
    <span class="c1"># number of plants</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="c1"># simulate initial heights</span>
    <span class="n">h0</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"h0"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,))</span>

    <span class="c1"># assign treatments and simulate fungus and growth</span>
    <span class="n">treatment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">repeats</span><span class="o">=</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">fungus</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="s2">"fungus"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="n">total_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">probs</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">treatment</span> <span class="o">*</span> <span class="mf">0.4</span><span class="p">)))</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">h0</span> <span class="o">+</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"diff"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">fungus</span><span class="p">))</span>

    <span class="c1"># compose a clean data frame</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">"h0"</span><span class="p">:</span> <span class="n">h0</span><span class="p">,</span> <span class="s2">"h1"</span><span class="p">:</span> <span class="n">h1</span><span class="p">,</span> <span class="s2">"treatment"</span><span class="p">:</span> <span class="n">treatment</span><span class="p">,</span> <span class="s2">"fungus"</span><span class="p">:</span> <span class="n">fungus</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">h0</span><span class="p">,</span> <span class="n">h1</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"p"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">h0</span> <span class="o">*</span> <span class="n">p</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"h1"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">h1</span><span class="p">)</span>

<span class="n">m6_6</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m6_6</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p6_6</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">treatment</span><span class="p">,</span> <span class="n">fungus</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">h1</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
    <span class="n">bt</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bt"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">bf</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bf"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">bt</span> <span class="o">*</span> <span class="n">treatment</span> <span class="o">+</span> <span class="n">bf</span> <span class="o">*</span> <span class="n">fungus</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">h0</span> <span class="o">*</span> <span class="n">p</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"h1"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">h1</span><span class="p">)</span>

<span class="n">m6_7</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m6_7</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fungus</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fungus</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
          <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p6_7</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">treatment</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">h1</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
    <span class="n">bt</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bt"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">bt</span> <span class="o">*</span> <span class="n">treatment</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">h0</span> <span class="o">*</span> <span class="n">p</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"h1"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">h1</span><span class="p">)</span>

<span class="n">m6_8</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m6_8</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p6_8</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="n">post</span> <span class="o">=</span> <span class="n">m6_7</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">p6_7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_7</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span>
                         <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fungus</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fungus</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_7</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az6_7</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[26]:</span>
</div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>UserWarning: For one or more samples the posterior variance of the log predictive densities exceeds 0.4. This could be indication of WAIC starting to fail. 
See http://arxiv.org/abs/1507.04544 for details
</pre>
</div>
</div>

<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[26]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>Computed from 1000 by 100 log-likelihood matrix

        Estimate       SE
IC_waic   332.92    15.37
p_waic      4.21        -

There has been a warning during the calculation. Please check the results.</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.27">Code 7.27<a class="anchor-link" href="07-ulysses-compass.html#Code-7.27">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m6_6</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">77</span><span class="p">),</span> <span class="n">p6_6</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_6</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_6</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m6_7</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">77</span><span class="p">),</span> <span class="n">p6_7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_7</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span>
                         <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fungus</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fungus</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_7</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m6_8</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">77</span><span class="p">),</span> <span class="n">p6_8</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_8</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_8</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">az</span><span class="o">.</span><span class="n">compare</span><span class="p">({</span><span class="s2">"m6.6"</span><span class="p">:</span> <span class="n">az6_6</span><span class="p">,</span> <span class="s2">"m6.7"</span><span class="p">:</span> <span class="n">az6_7</span><span class="p">,</span> <span class="s2">"m6.8"</span><span class="p">:</span> <span class="n">az6_8</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[27]:</span>
</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>rank</th>
      <th>waic</th>
      <th>p_waic</th>
      <th>d_waic</th>
      <th>weight</th>
      <th>se</th>
      <th>dse</th>
      <th>warning</th>
      <th>waic_scale</th>
    </tr></thead>
<tbody>
<tr>
<th>m6.7</th>
      <td>0</td>
      <td>332.89</td>
      <td>4.1697</td>
      <td>0</td>
      <td>0.998704</td>
      <td>12.3476</td>
      <td>0</td>
      <td>True</td>
      <td>deviance</td>
    </tr>
<tr>
<th>m6.8</th>
      <td>1</td>
      <td>395.65</td>
      <td>2.82591</td>
      <td>62.7609</td>
      <td>0.00129615</td>
      <td>12.3715</td>
      <td>14.2717</td>
      <td>False</td>
      <td>deviance</td>
    </tr>
<tr>
<th>m6.6</th>
      <td>2</td>
      <td>407.817</td>
      <td>1.80593</td>
      <td>74.9273</td>
      <td>8.85902e-08</td>
      <td>14.9847</td>
      <td>15.0407</td>
      <td>False</td>
      <td>deviance</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.28">Code 7.28<a class="anchor-link" href="07-ulysses-compass.html#Code-7.28">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m6_7</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">91</span><span class="p">),</span> <span class="n">p6_7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_7</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span>
                         <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fungus</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fungus</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_7</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">waic_m6_7</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az6_7</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m6_8</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">91</span><span class="p">),</span> <span class="n">p6_8</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_8</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_8</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">waic_m6_8</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az6_8</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">waic_m6_7</span><span class="o">.</span><span class="n">n_data_points</span>
<span class="n">diff_m6_7_m6_8</span> <span class="o">=</span> <span class="n">waic_m6_7</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">waic_m6_8</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">diff_m6_7_m6_8</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[28]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(14.284817, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.29">Code 7.29<a class="anchor-link" href="07-ulysses-compass.html#Code-7.29">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mf">40.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">10.4</span> <span class="o">*</span> <span class="mf">2.6</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[29]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([12.9600029, 67.03999329], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.30">Code 7.30<a class="anchor-link" href="07-ulysses-compass.html#Code-7.30">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">compare</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">compare</span><span class="p">({</span><span class="s2">"m6.6"</span><span class="p">:</span> <span class="n">az6_6</span><span class="p">,</span> <span class="s2">"m6.7"</span><span class="p">:</span> <span class="n">az6_7</span><span class="p">,</span> <span class="s2">"m6.8"</span><span class="p">:</span> <span class="n">az6_8</span><span class="p">})</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_compare</span><span class="p">(</span><span class="n">compare</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[30]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="224.39952pt" version="1.1" viewbox="0 0 440.39952 224.39952" width="440.39952pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 224.39952 
L 440.39952 224.39952 
L 440.39952 -0 
L 0 -0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 41.791395 185.393164 
L 433.19952 185.393164 
L 433.19952 7.2 
L 41.791395 7.2 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#p9d0e4a892b)" d="M 58.281416 185.393164 
L 58.281416 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 320 --><defs><path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><g style="fill:#262626;" transform="translate(46.710234 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-51"></use><use x="63.623047" xlink:href="#DejaVuSans-50"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#p9d0e4a892b)" d="M 127.646329 185.393164 
L 127.646329 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 340 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(116.075147 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-51"></use><use x="63.623047" xlink:href="#DejaVuSans-52"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#p9d0e4a892b)" d="M 197.011242 185.393164 
L 197.011242 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 360 --><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(185.440061 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-51"></use><use x="63.623047" xlink:href="#DejaVuSans-54"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#p9d0e4a892b)" d="M 266.376156 185.393164 
L 266.376156 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 380 --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(254.804974 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-51"></use><use x="63.623047" xlink:href="#DejaVuSans-56"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#p9d0e4a892b)" d="M 335.741069 185.393164 
L 335.741069 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 400 --><g style="fill:#262626;" transform="translate(324.169887 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#p9d0e4a892b)" d="M 405.105982 185.393164 
L 405.105982 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 420 --><g style="fill:#262626;" transform="translate(393.5348 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-52"></use><use x="63.623047" xlink:href="#DejaVuSans-50"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="text_7"><!-- Deviance --><defs><path d="M 19.671875 64.796875 
L 19.671875 8.109375 
L 31.59375 8.109375 
Q 46.6875 8.109375 53.6875 14.9375 
Q 60.6875 21.78125 60.6875 36.53125 
Q 60.6875 51.171875 53.6875 57.984375 
Q 46.6875 64.796875 31.59375 64.796875 
z
M 9.8125 72.90625 
L 30.078125 72.90625 
Q 51.265625 72.90625 61.171875 64.09375 
Q 71.09375 55.28125 71.09375 36.53125 
Q 71.09375 17.671875 61.125 8.828125 
Q 51.171875 0 30.078125 0 
L 9.8125 0 
z
" id="DejaVuSans-68"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path></defs><g style="fill:#262626;" transform="translate(207.18423 214.497927)scale(0.129904 -0.129904)"><use xlink:href="#DejaVuSans-68"></use><use x="77.001953" xlink:href="#DejaVuSans-101"></use><use x="138.525391" xlink:href="#DejaVuSans-118"></use><use x="197.705078" xlink:href="#DejaVuSans-105"></use><use x="225.488281" xlink:href="#DejaVuSans-97"></use><use x="286.767578" xlink:href="#DejaVuSans-110"></use><use x="350.146484" xlink:href="#DejaVuSans-99"></use><use x="405.126953" xlink:href="#DejaVuSans-101"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_13"><path clip-path="url(#p9d0e4a892b)" d="M 41.791395 36.898861 
L 433.19952 36.898861 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_8"><!-- m6.7 --><defs><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><g style="fill:#262626;" transform="translate(7.2 41.505169)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-54"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-55"></use></g></g></g><g id="ytick_2"><g id="line2d_15"><path clip-path="url(#p9d0e4a892b)" d="M 41.791395 81.447152 
L 433.19952 81.447152 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g></g><g id="ytick_3"><g id="line2d_17"><path clip-path="url(#p9d0e4a892b)" d="M 41.791395 96.296582 
L 433.19952 96.296582 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_9"><!-- m6.8 --><g style="fill:#262626;" transform="translate(7.2 100.90289)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-54"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="ytick_4"><g id="line2d_19"><path clip-path="url(#p9d0e4a892b)" d="M 41.791395 140.844873 
L 433.19952 140.844873 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g></g><g id="ytick_5"><g id="line2d_21"><path clip-path="url(#p9d0e4a892b)" d="M 41.791395 155.694303 
L 433.19952 155.694303 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_22"></g><g id="text_10"><!-- m6.6 --><g style="fill:#262626;" transform="translate(7.2 160.300611)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-54"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-54"></use></g></g></g></g><g id="LineCollection_1"><path clip-path="url(#p9d0e4a892b)" d="M 271.429981 81.447152 
L 370.516492 81.447152 
" style="fill:none;stroke:#808080;stroke-width:1.299038;"></path><path clip-path="url(#p9d0e4a892b)" d="M 310.56692 140.844873 
L 415.136772 140.844873 
" style="fill:none;stroke:#808080;stroke-width:1.299038;"></path></g><g id="LineCollection_2"><path clip-path="url(#p9d0e4a892b)" d="M 59.582673 36.898861 
L 145.78849 36.898861 
" style="fill:none;stroke:#000000;stroke-width:1.299038;"></path><path clip-path="url(#p9d0e4a892b)" d="M 276.224073 96.296582 
L 365.7224 96.296582 
" style="fill:none;stroke:#000000;stroke-width:1.299038;"></path><path clip-path="url(#p9d0e4a892b)" d="M 310.29545 155.694303 
L 415.408242 155.694303 
" style="fill:none;stroke:#000000;stroke-width:1.299038;"></path></g><g id="line2d_23"><path clip-path="url(#p9d0e4a892b)" d="M 73.889669 36.898861 
L 300.995807 96.296582 
L 350.325054 155.694303 
" style="fill:none;"></path><defs><path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m49638d041f" style="stroke:#000000;stroke-width:1.299038;"></path></defs><g clip-path="url(#p9d0e4a892b)"><use style="stroke:#000000;stroke-width:1.299038;" x="73.889669" xlink:href="#m49638d041f" y="36.898861"></use><use style="stroke:#000000;stroke-width:1.299038;" x="300.995807" xlink:href="#m49638d041f" y="96.296582"></use><use style="stroke:#000000;stroke-width:1.299038;" x="350.325054" xlink:href="#m49638d041f" y="155.694303"></use></g></g><g id="line2d_24"><path clip-path="url(#p9d0e4a892b)" d="M 102.685581 185.393164 
L 102.685581 7.2 
" style="fill:none;stroke:#808080;stroke-dasharray:4.806441,2.078461;stroke-dashoffset:0;stroke-width:1.299038;"></path></g><g id="line2d_25"><defs><path d="M 0 -3 
L -3 3 
L 3 3 
z
" id="mb010cc47b4" style="stroke:#808080;stroke-linejoin:miter;stroke-width:1.299038;"></path></defs><g clip-path="url(#p9d0e4a892b)"><use style="fill:#808080;stroke:#808080;stroke-linejoin:miter;stroke-width:1.299038;" x="320.973237" xlink:href="#mb010cc47b4" y="81.447152"></use><use style="fill:#808080;stroke:#808080;stroke-linejoin:miter;stroke-width:1.299038;" x="362.851846" xlink:href="#mb010cc47b4" y="140.844873"></use></g></g><g id="line2d_26"><defs><path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="ma9a33f4e56" style="stroke:#000000;stroke-width:1.299038;"></path></defs><g clip-path="url(#p9d0e4a892b)"><use style="fill-opacity:0;stroke:#000000;stroke-width:1.299038;" x="102.685581" xlink:href="#ma9a33f4e56" y="36.898861"></use><use style="fill-opacity:0;stroke:#000000;stroke-width:1.299038;" x="320.973237" xlink:href="#ma9a33f4e56" y="96.296582"></use><use style="fill-opacity:0;stroke:#000000;stroke-width:1.299038;" x="362.851846" xlink:href="#ma9a33f4e56" y="155.694303"></use></g></g><g id="patch_3"><path d="M 41.791395 185.393164 
L 41.791395 7.2 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 433.19952 185.393164 
L 433.19952 7.2 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 41.791395 185.393164 
L 433.19952 185.393164 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 41.791395 7.2 
L 433.19952 7.2 
" style="fill:none;"></path></g></g></g><defs><clippath id="p9d0e4a892b"><rect height="178.193164" width="391.408125" x="41.791395" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.31">Code 7.31<a class="anchor-link" href="07-ulysses-compass.html#Code-7.31">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m6_6</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">92</span><span class="p">),</span> <span class="n">p6_6</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_6</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_6</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">waic_m6_6</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az6_6</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">diff_m6_6_m6_8</span> <span class="o">=</span> <span class="n">waic_m6_6</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">waic_m6_8</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">diff_m6_6_m6_8</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[31]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(7.3126135, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.32">Code 7.32<a class="anchor-link" href="07-ulysses-compass.html#Code-7.32">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m6_6</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">93</span><span class="p">),</span> <span class="n">p6_6</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_6</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_6</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">waic_m6_6</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az6_6</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m6_7</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">93</span><span class="p">),</span> <span class="n">p6_7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_7</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span>
                         <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">fungus</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">fungus</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_7</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">waic_m6_7</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az6_7</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m6_8</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">93</span><span class="p">),</span> <span class="n">p6_8</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m6_8</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">treatment</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">treatment</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">h0</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h0</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">h1</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">az6_8</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="s2">"h1"</span><span class="p">][</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">waic_m6_8</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az6_8</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dSE</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">waic1</span><span class="p">,</span> <span class="n">waic2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
    <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">waic1</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">waic2</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"m6.6"</span><span class="p">:</span> <span class="n">waic_m6_6</span><span class="p">,</span> <span class="s2">"m6.7"</span><span class="p">:</span> <span class="n">waic_m6_7</span><span class="p">,</span> <span class="s2">"m6.8"</span><span class="p">:</span> <span class="n">waic_m6_8</span><span class="p">}</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="n">row</span><span class="p">:</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">dSE</span><span class="p">(</span><span class="n">row_val</span><span class="p">,</span> <span class="n">col_val</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">col_val</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
     <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_val</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[32]:</span>
</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>m6.6</th>
      <th>m6.7</th>
      <th>m6.8</th>
    </tr></thead>
<tbody>
<tr>
<th>m6.6</th>
      <td>0.0</td>
      <td>15.058242</td>
      <td>7.3767486</td>
    </tr>
<tr>
<th>m6.7</th>
      <td>15.058242</td>
      <td>0.0</td>
      <td>14.267287</td>
    </tr>
<tr>
<th>m6.8</th>
      <td>7.3767486</td>
      <td>14.267287</td>
      <td>0.0</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.33">Code 7.33<a class="anchor-link" href="07-ulysses-compass.html#Code-7.33">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Primates301</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"../data/Primates301.csv"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">";"</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Primates301</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.34">Code 7.34<a class="anchor-link" href="07-ulysses-compass.html#Code-7.34">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="p">[</span><span class="s2">"log_L"</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">longevity</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">onp</span><span class="o">.</span><span class="n">log</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="n">d</span><span class="p">[</span><span class="s2">"log_B"</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">brain</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">onp</span><span class="o">.</span><span class="n">log</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="n">d</span><span class="p">[</span><span class="s2">"log_M"</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">onp</span><span class="o">.</span><span class="n">log</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.35">Code 7.35<a class="anchor-link" href="07-ulysses-compass.html#Code-7.35">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span><span class="p">[[</span><span class="s2">"log_L"</span><span class="p">,</span> <span class="s2">"log_B"</span><span class="p">,</span> <span class="s2">"log_M"</span><span class="p">]]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[35]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>log_L    181
log_B    117
log_M     63
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.36">Code 7.36<a class="anchor-link" href="07-ulysses-compass.html#Code-7.36">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">d</span><span class="p">[[</span><span class="s2">"log_L"</span><span class="p">,</span> <span class="s2">"log_B"</span><span class="p">,</span> <span class="s2">"log_M"</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">d2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[36]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>112</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.37">Code 7.37<a class="anchor-link" href="07-ulysses-compass.html#Code-7.37">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">log_M</span><span class="p">,</span> <span class="n">log_B</span><span class="p">,</span> <span class="n">log_L</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
    <span class="n">bM</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bM"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">bB</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bB"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">bM</span> <span class="o">*</span> <span class="n">log_M</span> <span class="o">+</span> <span class="n">bB</span> <span class="o">*</span> <span class="n">log_B</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_L"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">log_L</span><span class="p">)</span>

<span class="n">m7_8</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_8</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">log_M</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_M</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">log_B</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_B</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">log_L</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p7_8</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.38">Code 7.38<a class="anchor-link" href="07-ulysses-compass.html#Code-7.38">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">log_B</span><span class="p">,</span> <span class="n">log_L</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
    <span class="n">bB</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bB"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">bB</span> <span class="o">*</span> <span class="n">log_B</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_L"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">log_L</span><span class="p">)</span>

<span class="n">m7_9</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_9</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">log_B</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_B</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">log_L</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p7_9</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">log_M</span><span class="p">,</span> <span class="n">log_L</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
    <span class="n">bM</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bM"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">bM</span> <span class="o">*</span> <span class="n">log_M</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_L"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">log_L</span><span class="p">)</span>

<span class="n">m7_10</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_10</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">log_M</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_M</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">log_L</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p7_10</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.39">Code 7.39<a class="anchor-link" href="07-ulysses-compass.html#Code-7.39">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post</span> <span class="o">=</span> <span class="n">m7_8</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">301</span><span class="p">),</span> <span class="n">p7_8</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m7_8</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">log_M</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_M</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">log_B</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_B</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">log_L</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="s2">"log_L"</span><span class="p">]</span>
<span class="n">az7_8</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m7_9</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">301</span><span class="p">),</span> <span class="n">p7_9</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m7_9</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">log_B</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_B</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">log_L</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="s2">"log_L"</span><span class="p">]</span>
<span class="n">az7_9</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m7_10</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">301</span><span class="p">),</span> <span class="n">p7_10</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">log_likelihood</span><span class="p">(</span><span class="n">m7_10</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">log_M</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_M</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                         <span class="n">log_L</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="s2">"log_L"</span><span class="p">]</span>
<span class="n">az7_10</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">sample_stats</span><span class="o">=</span><span class="p">{</span><span class="s2">"log_likelihood"</span><span class="p">:</span> <span class="n">logprob</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]})</span>
<span class="n">az</span><span class="o">.</span><span class="n">compare</span><span class="p">({</span><span class="s2">"m7.8"</span><span class="p">:</span> <span class="n">az7_8</span><span class="p">,</span> <span class="s2">"m7.9"</span><span class="p">:</span> <span class="n">az7_9</span><span class="p">,</span> <span class="s2">"m7.10"</span><span class="p">:</span> <span class="n">az7_10</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[39]:</span>
</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>rank</th>
      <th>waic</th>
      <th>p_waic</th>
      <th>d_waic</th>
      <th>weight</th>
      <th>se</th>
      <th>dse</th>
      <th>warning</th>
      <th>waic_scale</th>
    </tr></thead>
<tbody>
<tr>
<th>m7.8</th>
      <td>0</td>
      <td>216.211</td>
      <td>3.4393</td>
      <td>0</td>
      <td>0.512241</td>
      <td>14.5935</td>
      <td>0</td>
      <td>False</td>
      <td>deviance</td>
    </tr>
<tr>
<th>m7.9</th>
      <td>1</td>
      <td>216.363</td>
      <td>2.52811</td>
      <td>0.151344</td>
      <td>0.4708</td>
      <td>14.7528</td>
      <td>1.47512</td>
      <td>False</td>
      <td>deviance</td>
    </tr>
<tr>
<th>m7.10</th>
      <td>2</td>
      <td>229.463</td>
      <td>2.52649</td>
      <td>13.2516</td>
      <td>0.0169586</td>
      <td>16.0461</td>
      <td>6.95986</td>
      <td>False</td>
      <td>deviance</td>
    </tr>
</tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.40">Code 7.40<a class="anchor-link" href="07-ulysses-compass.html#Code-7.40">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">compare</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">compare</span><span class="p">({</span><span class="s2">"m7.8"</span><span class="p">:</span> <span class="n">az7_8</span><span class="p">,</span> <span class="s2">"m7.9"</span><span class="p">:</span> <span class="n">az7_9</span><span class="p">,</span> <span class="s2">"m7.10"</span><span class="p">:</span> <span class="n">az7_10</span><span class="p">})</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_compare</span><span class="p">(</span><span class="n">compare</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[40]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="224.39952pt" version="1.1" viewbox="0 0 440.39952 224.39952" width="440.39952pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 224.39952 
L 440.39952 224.39952 
L 440.39952 -0 
L 0 -0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 49.505516 185.393164 
L 433.19952 185.393164 
L 433.19952 7.2 
L 49.505516 7.2 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#pb981f27ae3)" d="M 50.312854 185.393164 
L 50.312854 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 200 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path></defs><g style="fill:#262626;" transform="translate(38.741672 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#pb981f27ae3)" d="M 130.793633 185.393164 
L 130.793633 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 210 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(119.222451 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-49"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#pb981f27ae3)" d="M 211.274412 185.393164 
L 211.274412 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 220 --><g style="fill:#262626;" transform="translate(199.70323 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-50"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#pb981f27ae3)" d="M 291.755191 185.393164 
L 291.755191 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 230 --><defs><path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path></defs><g style="fill:#262626;" transform="translate(280.184009 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-51"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#pb981f27ae3)" d="M 372.23597 185.393164 
L 372.23597 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 240 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(360.664788 198.10578)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-50"></use><use x="63.623047" xlink:href="#DejaVuSans-52"></use><use x="127.246094" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="text_6"><!-- Deviance --><defs><path d="M 19.671875 64.796875 
L 19.671875 8.109375 
L 31.59375 8.109375 
Q 46.6875 8.109375 53.6875 14.9375 
Q 60.6875 21.78125 60.6875 36.53125 
Q 60.6875 51.171875 53.6875 57.984375 
Q 46.6875 64.796875 31.59375 64.796875 
z
M 9.8125 72.90625 
L 30.078125 72.90625 
Q 51.265625 72.90625 61.171875 64.09375 
Q 71.09375 55.28125 71.09375 36.53125 
Q 71.09375 17.671875 61.125 8.828125 
Q 51.171875 0 30.078125 0 
L 9.8125 0 
z
" id="DejaVuSans-68"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path></defs><g style="fill:#262626;" transform="translate(211.04129 214.497927)scale(0.129904 -0.129904)"><use xlink:href="#DejaVuSans-68"></use><use x="77.001953" xlink:href="#DejaVuSans-101"></use><use x="138.525391" xlink:href="#DejaVuSans-118"></use><use x="197.705078" xlink:href="#DejaVuSans-105"></use><use x="225.488281" xlink:href="#DejaVuSans-97"></use><use x="286.767578" xlink:href="#DejaVuSans-110"></use><use x="350.146484" xlink:href="#DejaVuSans-99"></use><use x="405.126953" xlink:href="#DejaVuSans-101"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_11"><path clip-path="url(#pb981f27ae3)" d="M 49.505516 36.898861 
L 433.19952 36.898861 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_7"><!-- m7.8 --><defs><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(14.914121 41.505169)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="ytick_2"><g id="line2d_13"><path clip-path="url(#pb981f27ae3)" d="M 49.505516 81.447152 
L 433.19952 81.447152 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g></g><g id="ytick_3"><g id="line2d_15"><path clip-path="url(#pb981f27ae3)" d="M 49.505516 96.296582 
L 433.19952 96.296582 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_8"><!-- m7.9 --><defs><path d="M 10.984375 1.515625 
L 10.984375 10.5 
Q 14.703125 8.734375 18.5 7.8125 
Q 22.3125 6.890625 25.984375 6.890625 
Q 35.75 6.890625 40.890625 13.453125 
Q 46.046875 20.015625 46.78125 33.40625 
Q 43.953125 29.203125 39.59375 26.953125 
Q 35.25 24.703125 29.984375 24.703125 
Q 19.046875 24.703125 12.671875 31.3125 
Q 6.296875 37.9375 6.296875 49.421875 
Q 6.296875 60.640625 12.9375 67.421875 
Q 19.578125 74.21875 30.609375 74.21875 
Q 43.265625 74.21875 49.921875 64.515625 
Q 56.59375 54.828125 56.59375 36.375 
Q 56.59375 19.140625 48.40625 8.859375 
Q 40.234375 -1.421875 26.421875 -1.421875 
Q 22.703125 -1.421875 18.890625 -0.6875 
Q 15.09375 0.046875 10.984375 1.515625 
z
M 30.609375 32.421875 
Q 37.25 32.421875 41.125 36.953125 
Q 45.015625 41.5 45.015625 49.421875 
Q 45.015625 57.28125 41.125 61.84375 
Q 37.25 66.40625 30.609375 66.40625 
Q 23.96875 66.40625 20.09375 61.84375 
Q 16.21875 57.28125 16.21875 49.421875 
Q 16.21875 41.5 20.09375 36.953125 
Q 23.96875 32.421875 30.609375 32.421875 
z
" id="DejaVuSans-57"></path></defs><g style="fill:#262626;" transform="translate(14.914121 100.90289)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-57"></use></g></g></g><g id="ytick_4"><g id="line2d_17"><path clip-path="url(#pb981f27ae3)" d="M 49.505516 140.844873 
L 433.19952 140.844873 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g></g><g id="ytick_5"><g id="line2d_19"><path clip-path="url(#pb981f27ae3)" d="M 49.505516 155.694303 
L 433.19952 155.694303 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_9"><!-- m7.10 --><g style="fill:#262626;" transform="translate(7.2 160.300611)scale(0.121244 -0.121244)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-49"></use><use x="256.445312" xlink:href="#DejaVuSans-48"></use></g></g></g></g><g id="LineCollection_1"><path clip-path="url(#pb981f27ae3)" d="M 170.130202 81.447152 
L 193.87397 81.447152 
" style="fill:none;stroke:#808080;stroke-width:1.299038;"></path><path clip-path="url(#pb981f27ae3)" d="M 231.420155 140.844873 
L 343.447087 140.844873 
" style="fill:none;stroke:#808080;stroke-width:1.299038;"></path></g><g id="LineCollection_2"><path clip-path="url(#pb981f27ae3)" d="M 67.308602 36.898861 
L 294.259507 36.898861 
" style="fill:none;stroke:#000000;stroke-width:1.299038;"></path><path clip-path="url(#pb981f27ae3)" d="M 66.946152 96.296582 
L 297.05802 96.296582 
" style="fill:none;stroke:#000000;stroke-width:1.299038;"></path><path clip-path="url(#pb981f27ae3)" d="M 159.108359 155.694303 
L 415.758883 155.694303 
" style="fill:none;stroke:#000000;stroke-width:1.299038;"></path></g><g id="line2d_21"><path clip-path="url(#pb981f27ae3)" d="M 125.424522 36.898861 
L 141.30931 96.296582 
L 246.766872 155.694303 
" style="fill:none;"></path><defs><path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m99b872c00f" style="stroke:#000000;stroke-width:1.299038;"></path></defs><g clip-path="url(#pb981f27ae3)"><use style="stroke:#000000;stroke-width:1.299038;" x="125.424522" xlink:href="#m99b872c00f" y="36.898861"></use><use style="stroke:#000000;stroke-width:1.299038;" x="141.30931" xlink:href="#m99b872c00f" y="96.296582"></use><use style="stroke:#000000;stroke-width:1.299038;" x="246.766872" xlink:href="#m99b872c00f" y="155.694303"></use></g></g><g id="line2d_22"><path clip-path="url(#pb981f27ae3)" d="M 180.784055 185.393164 
L 180.784055 7.2 
" style="fill:none;stroke:#808080;stroke-dasharray:4.806441,2.078461;stroke-dashoffset:0;stroke-width:1.299038;"></path></g><g id="line2d_23"><defs><path d="M 0 -3 
L -3 3 
L 3 3 
z
" id="m5502b5af8a" style="stroke:#808080;stroke-linejoin:miter;stroke-width:1.299038;"></path></defs><g clip-path="url(#pb981f27ae3)"><use style="fill:#808080;stroke:#808080;stroke-linejoin:miter;stroke-width:1.299038;" x="182.002086" xlink:href="#m5502b5af8a" y="81.447152"></use><use style="fill:#808080;stroke:#808080;stroke-linejoin:miter;stroke-width:1.299038;" x="287.433621" xlink:href="#m5502b5af8a" y="140.844873"></use></g></g><g id="line2d_24"><defs><path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="mb03c89eae1" style="stroke:#000000;stroke-width:1.299038;"></path></defs><g clip-path="url(#pb981f27ae3)"><use style="fill-opacity:0;stroke:#000000;stroke-width:1.299038;" x="180.784055" xlink:href="#mb03c89eae1" y="36.898861"></use><use style="fill-opacity:0;stroke:#000000;stroke-width:1.299038;" x="182.002086" xlink:href="#mb03c89eae1" y="96.296582"></use><use style="fill-opacity:0;stroke:#000000;stroke-width:1.299038;" x="287.433621" xlink:href="#mb03c89eae1" y="155.694303"></use></g></g><g id="patch_3"><path d="M 49.505516 185.393164 
L 49.505516 7.2 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 433.19952 185.393164 
L 433.19952 7.2 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 49.505516 185.393164 
L 433.19952 185.393164 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 49.505516 7.2 
L 433.19952 7.2 
" style="fill:none;"></path></g></g></g><defs><clippath id="pb981f27ae3"><rect height="178.193164" width="383.694004" x="49.505516" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.41">Code 7.41<a class="anchor-link" href="07-ulysses-compass.html#Code-7.41">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coeftab</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"m7.8"</span><span class="p">:</span> <span class="n">m7_8</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p7_8</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,)),</span>
           <span class="s2">"m7.9"</span><span class="p">:</span> <span class="n">m7_9</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">p7_9</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,)),</span>
           <span class="s2">"m7.10"</span><span class="p">:</span> <span class="n">m7_10</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">p7_10</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))}</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">coeftab</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">model_names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">coeftab</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
               <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s2">"bM"</span><span class="p">,</span> <span class="s2">"bB"</span><span class="p">],</span> <span class="n">credible_interval</span><span class="o">=</span><span class="mf">0.89</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[41]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="685.19952pt" version="1.1" viewbox="0 0 440.39952 685.19952" width="440.39952pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 685.19952 
L 440.39952 685.19952 
L 440.39952 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 85.641563 660.950145 
L 433.19952 660.950145 
L 433.19952 25.3575 
L 85.641563 25.3575 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#paeaf33e22a)" d="M 118.63077 660.950145 
L 118.63077 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- −0.5 --><defs><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"></path></defs><g style="fill:#262626;" transform="translate(101.632802 675.087958)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#paeaf33e22a)" d="M 204.143673 660.950145 
L 204.143673 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 0.0 --><g style="fill:#262626;" transform="translate(193.011485 675.087958)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#paeaf33e22a)" d="M 289.656575 660.950145 
L 289.656575 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.5 --><g style="fill:#262626;" transform="translate(278.524388 675.087958)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-53"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#paeaf33e22a)" d="M 375.169478 660.950145 
L 375.169478 25.3575 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 1.0 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(364.03729 675.087958)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="text_5"><!-- m7.9: bB --><defs><path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"></path><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path><path d="M 10.984375 1.515625 
L 10.984375 10.5 
Q 14.703125 8.734375 18.5 7.8125 
Q 22.3125 6.890625 25.984375 6.890625 
Q 35.75 6.890625 40.890625 13.453125 
Q 46.046875 20.015625 46.78125 33.40625 
Q 43.953125 29.203125 39.59375 26.953125 
Q 35.25 24.703125 29.984375 24.703125 
Q 19.046875 24.703125 12.671875 31.3125 
Q 6.296875 37.9375 6.296875 49.421875 
Q 6.296875 60.640625 12.9375 67.421875 
Q 19.578125 74.21875 30.609375 74.21875 
Q 43.265625 74.21875 49.921875 64.515625 
Q 56.59375 54.828125 56.59375 36.375 
Q 56.59375 19.140625 48.40625 8.859375 
Q 40.234375 -1.421875 26.421875 -1.421875 
Q 22.703125 -1.421875 18.890625 -0.6875 
Q 15.09375 0.046875 10.984375 1.515625 
z
M 30.609375 32.421875 
Q 37.25 32.421875 41.125 36.953125 
Q 45.015625 41.5 45.015625 49.421875 
Q 45.015625 57.28125 41.125 61.84375 
Q 37.25 66.40625 30.609375 66.40625 
Q 23.96875 66.40625 20.09375 61.84375 
Q 16.21875 57.28125 16.21875 49.421875 
Q 16.21875 41.5 20.09375 36.953125 
Q 23.96875 32.421875 30.609375 32.421875 
z
" id="DejaVuSans-57"></path><path d="M 11.71875 12.40625 
L 22.015625 12.40625 
L 22.015625 0 
L 11.71875 0 
z
M 11.71875 51.703125 
L 22.015625 51.703125 
L 22.015625 39.3125 
L 11.71875 39.3125 
z
" id="DejaVuSans-58"></path><path id="DejaVuSans-32"></path><path d="M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
M 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
z
" id="DejaVuSans-98"></path><path d="M 19.671875 34.8125 
L 19.671875 8.109375 
L 35.5 8.109375 
Q 43.453125 8.109375 47.28125 11.40625 
Q 51.125 14.703125 51.125 21.484375 
Q 51.125 28.328125 47.28125 31.5625 
Q 43.453125 34.8125 35.5 34.8125 
z
M 19.671875 64.796875 
L 19.671875 42.828125 
L 34.28125 42.828125 
Q 41.5 42.828125 45.03125 45.53125 
Q 48.578125 48.25 48.578125 53.8125 
Q 48.578125 59.328125 45.03125 62.0625 
Q 41.5 64.796875 34.28125 64.796875 
z
M 9.8125 72.90625 
L 35.015625 72.90625 
Q 46.296875 72.90625 52.390625 68.21875 
Q 58.5 63.53125 58.5 54.890625 
Q 58.5 48.1875 55.375 44.234375 
Q 52.25 40.28125 46.1875 39.3125 
Q 53.46875 37.75 57.5 32.78125 
Q 61.53125 27.828125 61.53125 20.40625 
Q 61.53125 10.640625 54.890625 5.3125 
Q 48.25 0 35.984375 0 
L 9.8125 0 
z
" id="DejaVuSans-66"></path></defs><g style="fill:#262626;" transform="translate(18.581562 554.105643)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-57"></use><use x="256.445312" xlink:href="#DejaVuSans-58"></use><use x="290.136719" xlink:href="#DejaVuSans-32"></use><use x="321.923828" xlink:href="#DejaVuSans-98"></use><use x="385.400391" xlink:href="#DejaVuSans-66"></use></g></g></g><g id="ytick_2"><g id="text_6"><!-- m7.8: bB --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(18.581562 460.636137)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-56"></use><use x="256.445312" xlink:href="#DejaVuSans-58"></use><use x="290.136719" xlink:href="#DejaVuSans-32"></use><use x="321.923828" xlink:href="#DejaVuSans-98"></use><use x="385.400391" xlink:href="#DejaVuSans-66"></use></g></g></g><g id="ytick_3"><g id="text_7"><!-- m7.10: bM --><defs><path d="M 9.8125 72.90625 
L 24.515625 72.90625 
L 43.109375 23.296875 
L 61.8125 72.90625 
L 76.515625 72.90625 
L 76.515625 0 
L 66.890625 0 
L 66.890625 64.015625 
L 48.09375 14.015625 
L 38.1875 14.015625 
L 19.390625 64.015625 
L 19.390625 0 
L 9.8125 0 
z
" id="DejaVuSans-77"></path></defs><g style="fill:#262626;" transform="translate(7.2 236.309321)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-49"></use><use x="256.445312" xlink:href="#DejaVuSans-48"></use><use x="320.068359" xlink:href="#DejaVuSans-58"></use><use x="353.759766" xlink:href="#DejaVuSans-32"></use><use x="385.546875" xlink:href="#DejaVuSans-98"></use><use x="449.023438" xlink:href="#DejaVuSans-77"></use></g></g></g><g id="ytick_4"><g id="text_8"><!-- m7.8: bM --><g style="fill:#262626;" transform="translate(16.1075 142.839814)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-109"></use><use x="97.412109" xlink:href="#DejaVuSans-55"></use><use x="161.035156" xlink:href="#DejaVuSans-46"></use><use x="192.822266" xlink:href="#DejaVuSans-56"></use><use x="256.445312" xlink:href="#DejaVuSans-58"></use><use x="290.136719" xlink:href="#DejaVuSans-32"></use><use x="321.923828" xlink:href="#DejaVuSans-98"></use><use x="385.400391" xlink:href="#DejaVuSans-77"></use></g></g></g></g><g id="patch_3"><path clip-path="url(#paeaf33e22a)" d="M 85.641563 548.786737 
L 85.641563 343.153823 
L 433.19952 343.153823 
L 433.19952 548.786737 
z
" style="fill:none;opacity:0;"></path></g><g id="patch_4"><path clip-path="url(#paeaf33e22a)" d="M 85.641563 343.153823 
L 85.641563 25.3575 
L 433.19952 25.3575 
L 433.19952 343.153823 
z
" style="opacity:0.1;stroke:#000000;stroke-linejoin:miter;"></path></g><g id="LineCollection_1"><path clip-path="url(#paeaf33e22a)" d="M 304.077177 548.786737 
L 335.552727 548.786737 
" style="fill:none;stroke:#fa7c17;stroke-width:1.5;"></path></g><g id="LineCollection_2"><path clip-path="url(#paeaf33e22a)" d="M 313.516539 548.786737 
L 326.158389 548.786737 
" style="fill:none;stroke:#fa7c17;stroke-width:3;"></path></g><g id="LineCollection_3"><path clip-path="url(#paeaf33e22a)" d="M 291.910423 455.31723 
L 417.401431 455.31723 
" style="fill:none;stroke:#2a2eec;stroke-width:1.5;"></path></g><g id="LineCollection_4"><path clip-path="url(#paeaf33e22a)" d="M 326.546724 455.31723 
L 376.107778 455.31723 
" style="fill:none;stroke:#2a2eec;stroke-width:3;"></path></g><g id="LineCollection_5"><path clip-path="url(#paeaf33e22a)" d="M 302.441724 230.990415 
L 337.301894 230.990415 
" style="fill:none;stroke:#328c06;stroke-width:1.5;"></path></g><g id="LineCollection_6"><path clip-path="url(#paeaf33e22a)" d="M 310.889599 230.990415 
L 325.686084 230.990415 
" style="fill:none;stroke:#328c06;stroke-width:3;"></path></g><g id="LineCollection_7"><path clip-path="url(#paeaf33e22a)" d="M 101.439651 137.520908 
L 225.04721 137.520908 
" style="fill:none;stroke:#2a2eec;stroke-width:1.5;"></path></g><g id="LineCollection_8"><path clip-path="url(#paeaf33e22a)" d="M 143.877077 137.520908 
L 197.797939 137.520908 
" style="fill:none;stroke:#2a2eec;stroke-width:3;"></path></g><g id="line2d_9"><defs><path d="M 0 2.25 
C 0.596707 2.25 1.169055 2.012926 1.59099 1.59099 
C 2.012926 1.169055 2.25 0.596707 2.25 0 
C 2.25 -0.596707 2.012926 -1.169055 1.59099 -1.59099 
C 1.169055 -2.012926 0.596707 -2.25 0 -2.25 
C -0.596707 -2.25 -1.169055 -2.012926 -1.59099 -1.59099 
C -2.012926 -1.169055 -2.25 -0.596707 -2.25 0 
C -2.25 0.596707 -2.012926 1.169055 -1.59099 1.59099 
C -1.169055 2.012926 -0.596707 2.25 0 2.25 
z
" id="m5e7427f4dd" style="stroke:#fa7c17;"></path></defs><g clip-path="url(#paeaf33e22a)"><use style="fill:#eeeeee;stroke:#fa7c17;" x="319.735103" xlink:href="#m5e7427f4dd" y="548.786737"></use></g></g><g id="line2d_10"><defs><path d="M 0 2.25 
C 0.596707 2.25 1.169055 2.012926 1.59099 1.59099 
C 2.012926 1.169055 2.25 0.596707 2.25 0 
C 2.25 -0.596707 2.012926 -1.169055 1.59099 -1.59099 
C 1.169055 -2.012926 0.596707 -2.25 0 -2.25 
C -0.596707 -2.25 -1.169055 -2.012926 -1.59099 -1.59099 
C -2.012926 -1.169055 -2.25 -0.596707 -2.25 0 
C -2.25 0.596707 -2.012926 1.169055 -1.59099 1.59099 
C -1.169055 2.012926 -0.596707 2.25 0 2.25 
z
" id="mc7d3086136" style="stroke:#2a2eec;"></path></defs><g clip-path="url(#paeaf33e22a)"><use style="fill:#eeeeee;stroke:#2a2eec;" x="352.054125" xlink:href="#mc7d3086136" y="455.31723"></use></g></g><g id="line2d_11"><defs><path d="M 0 2.25 
C 0.596707 2.25 1.169055 2.012926 1.59099 1.59099 
C 2.012926 1.169055 2.25 0.596707 2.25 0 
C 2.25 -0.596707 2.012926 -1.169055 1.59099 -1.59099 
C 1.169055 -2.012926 0.596707 -2.25 0 -2.25 
C -0.596707 -2.25 -1.169055 -2.012926 -1.59099 -1.59099 
C -2.012926 -1.169055 -2.25 -0.596707 -2.25 0 
C -2.25 0.596707 -2.012926 1.169055 -1.59099 1.59099 
C -1.169055 2.012926 -0.596707 2.25 0 2.25 
z
" id="m72de55ed7d" style="stroke:#328c06;"></path></defs><g clip-path="url(#paeaf33e22a)"><use style="fill:#eeeeee;stroke:#328c06;" x="318.64972" xlink:href="#m72de55ed7d" y="230.990415"></use></g></g><g id="line2d_12"><g clip-path="url(#paeaf33e22a)"><use style="fill:#eeeeee;stroke:#2a2eec;" x="171.116165" xlink:href="#mc7d3086136" y="137.520908"></use></g></g><g id="patch_5"><path d="M 85.641563 660.950145 
L 433.19952 660.950145 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 85.641563 25.3575 
L 433.19952 25.3575 
" style="fill:none;"></path></g><g id="text_9"><!-- 89.0% Credible Interval --><defs><path d="M 72.703125 32.078125 
Q 68.453125 32.078125 66.03125 28.46875 
Q 63.625 24.859375 63.625 18.40625 
Q 63.625 12.0625 66.03125 8.421875 
Q 68.453125 4.78125 72.703125 4.78125 
Q 76.859375 4.78125 79.265625 8.421875 
Q 81.6875 12.0625 81.6875 18.40625 
Q 81.6875 24.8125 79.265625 28.4375 
Q 76.859375 32.078125 72.703125 32.078125 
z
M 72.703125 38.28125 
Q 80.421875 38.28125 84.953125 32.90625 
Q 89.5 27.546875 89.5 18.40625 
Q 89.5 9.28125 84.9375 3.921875 
Q 80.375 -1.421875 72.703125 -1.421875 
Q 64.890625 -1.421875 60.34375 3.921875 
Q 55.8125 9.28125 55.8125 18.40625 
Q 55.8125 27.59375 60.375 32.9375 
Q 64.9375 38.28125 72.703125 38.28125 
z
M 22.3125 68.015625 
Q 18.109375 68.015625 15.6875 64.375 
Q 13.28125 60.75 13.28125 54.390625 
Q 13.28125 47.953125 15.671875 44.328125 
Q 18.0625 40.71875 22.3125 40.71875 
Q 26.5625 40.71875 28.96875 44.328125 
Q 31.390625 47.953125 31.390625 54.390625 
Q 31.390625 60.6875 28.953125 64.34375 
Q 26.515625 68.015625 22.3125 68.015625 
z
M 66.40625 74.21875 
L 74.21875 74.21875 
L 28.609375 -1.421875 
L 20.796875 -1.421875 
z
M 22.3125 74.21875 
Q 30.03125 74.21875 34.609375 68.875 
Q 39.203125 63.53125 39.203125 54.390625 
Q 39.203125 45.171875 34.640625 39.84375 
Q 30.078125 34.515625 22.3125 34.515625 
Q 14.546875 34.515625 10.03125 39.859375 
Q 5.515625 45.21875 5.515625 54.390625 
Q 5.515625 63.484375 10.046875 68.84375 
Q 14.59375 74.21875 22.3125 74.21875 
z
" id="DejaVuSans-37"></path><path d="M 64.40625 67.28125 
L 64.40625 56.890625 
Q 59.421875 61.53125 53.78125 63.8125 
Q 48.140625 66.109375 41.796875 66.109375 
Q 29.296875 66.109375 22.65625 58.46875 
Q 16.015625 50.828125 16.015625 36.375 
Q 16.015625 21.96875 22.65625 14.328125 
Q 29.296875 6.6875 41.796875 6.6875 
Q 48.140625 6.6875 53.78125 8.984375 
Q 59.421875 11.28125 64.40625 15.921875 
L 64.40625 5.609375 
Q 59.234375 2.09375 53.4375 0.328125 
Q 47.65625 -1.421875 41.21875 -1.421875 
Q 24.65625 -1.421875 15.125 8.703125 
Q 5.609375 18.84375 5.609375 36.375 
Q 5.609375 53.953125 15.125 64.078125 
Q 24.65625 74.21875 41.21875 74.21875 
Q 47.75 74.21875 53.53125 72.484375 
Q 59.328125 70.75 64.40625 67.28125 
z
" id="DejaVuSans-67"></path><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 0 
L 9.8125 0 
z
" id="DejaVuSans-73"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path></defs><g style="fill:#262626;" transform="translate(164.964291 19.3575)scale(0.16 -0.16)"><use xlink:href="#DejaVuSans-56"></use><use x="63.623047" xlink:href="#DejaVuSans-57"></use><use x="127.246094" xlink:href="#DejaVuSans-46"></use><use x="159.033203" xlink:href="#DejaVuSans-48"></use><use x="222.65625" xlink:href="#DejaVuSans-37"></use><use x="317.675781" xlink:href="#DejaVuSans-32"></use><use x="349.462891" xlink:href="#DejaVuSans-67"></use><use x="419.287109" xlink:href="#DejaVuSans-114"></use><use x="460.369141" xlink:href="#DejaVuSans-101"></use><use x="521.892578" xlink:href="#DejaVuSans-100"></use><use x="585.369141" xlink:href="#DejaVuSans-105"></use><use x="613.152344" xlink:href="#DejaVuSans-98"></use><use x="676.628906" xlink:href="#DejaVuSans-108"></use><use x="704.412109" xlink:href="#DejaVuSans-101"></use><use x="765.935547" xlink:href="#DejaVuSans-32"></use><use x="797.722656" xlink:href="#DejaVuSans-73"></use><use x="827.214844" xlink:href="#DejaVuSans-110"></use><use x="890.59375" xlink:href="#DejaVuSans-116"></use><use x="929.802734" xlink:href="#DejaVuSans-101"></use><use x="991.326172" xlink:href="#DejaVuSans-114"></use><use x="1032.439453" xlink:href="#DejaVuSans-118"></use><use x="1091.619141" xlink:href="#DejaVuSans-97"></use><use x="1152.898438" xlink:href="#DejaVuSans-108"></use></g></g></g></g><defs><clippath id="paeaf33e22a"><rect height="635.592645" width="347.557957" x="85.641563" y="25.3575"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.42">Code 7.42<a class="anchor-link" href="07-ulysses-compass.html#Code-7.42">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">onp</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">log_B</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">d2</span><span class="o">.</span><span class="n">log_M</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[42]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9796271811646352</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.43">Code 7.43<a class="anchor-link" href="07-ulysses-compass.html#Code-7.43">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">waic_m7_8</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az7_8</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">waic_m7_9</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">waic</span><span class="p">(</span><span class="n">az7_9</span><span class="p">,</span> <span class="n">pointwise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.44">Code 7.44<a class="anchor-link" href="07-ulysses-compass.html#Code-7.44">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># compute point scaling</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">d2</span><span class="o">.</span><span class="n">log_B</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">d2</span><span class="o">.</span><span class="n">log_M</span><span class="o">.</span><span class="n">values</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># draw the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">waic_m7_8</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">waic_m7_9</span><span class="o">.</span><span class="n">waic_i</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"pointwise difference in WAIC"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"log longevity (std)"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[44]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="267.406563pt" version="1.1" viewbox="0 0 391.85625 267.406563" width="391.85625pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 267.406563 
L 391.85625 267.406563 
L 391.85625 0 
L 0 0 
z
" style="fill:none;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 49.85625 224.64 
L 384.65625 224.64 
L 384.65625 7.2 
L 49.85625 7.2 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#p77e93ee763)" d="M 91.075056 224.64 
L 91.075056 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- −0.4 --><defs><path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(74.077087 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#p77e93ee763)" d="M 146.642166 224.64 
L 146.642166 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- −0.2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(129.644197 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-48"></use><use x="147.412109" xlink:href="#DejaVuSans-46"></use><use x="179.199219" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#p77e93ee763)" d="M 202.209275 224.64 
L 202.209275 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.0 --><g style="fill:#262626;" transform="translate(191.077088 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#p77e93ee763)" d="M 257.776385 224.64 
L 257.776385 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 0.2 --><g style="fill:#262626;" transform="translate(246.644197 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#p77e93ee763)" d="M 313.343495 224.64 
L 313.343495 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 0.4 --><g style="fill:#262626;" transform="translate(302.211307 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-52"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#p77e93ee763)" d="M 368.910604 224.64 
L 368.910604 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 0.6 --><defs><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(357.778417 238.777813)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-54"></use></g></g></g><g id="text_7"><!-- pointwise difference in WAIC --><defs><path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path><path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path><path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path><path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path><path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path><path d="M 4.203125 54.6875 
L 13.1875 54.6875 
L 24.421875 12.015625 
L 35.59375 54.6875 
L 46.1875 54.6875 
L 57.421875 12.015625 
L 68.609375 54.6875 
L 77.59375 54.6875 
L 63.28125 0 
L 52.6875 0 
L 40.921875 44.828125 
L 29.109375 0 
L 18.5 0 
z
" id="DejaVuSans-119"></path><path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path><path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path><path id="DejaVuSans-32"></path><path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path><path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path><path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path><path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path><path d="M 3.328125 72.90625 
L 13.28125 72.90625 
L 28.609375 11.28125 
L 43.890625 72.90625 
L 54.984375 72.90625 
L 70.3125 11.28125 
L 85.59375 72.90625 
L 95.609375 72.90625 
L 77.296875 0 
L 64.890625 0 
L 49.515625 63.28125 
L 33.984375 0 
L 21.578125 0 
z
" id="DejaVuSans-87"></path><path d="M 34.1875 63.1875 
L 20.796875 26.90625 
L 47.609375 26.90625 
z
M 28.609375 72.90625 
L 39.796875 72.90625 
L 67.578125 0 
L 57.328125 0 
L 50.6875 18.703125 
L 17.828125 18.703125 
L 11.1875 0 
L 0.78125 0 
z
" id="DejaVuSans-65"></path><path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 0 
L 9.8125 0 
z
" id="DejaVuSans-73"></path><path d="M 64.40625 67.28125 
L 64.40625 56.890625 
Q 59.421875 61.53125 53.78125 63.8125 
Q 48.140625 66.109375 41.796875 66.109375 
Q 29.296875 66.109375 22.65625 58.46875 
Q 16.015625 50.828125 16.015625 36.375 
Q 16.015625 21.96875 22.65625 14.328125 
Q 29.296875 6.6875 41.796875 6.6875 
Q 48.140625 6.6875 53.78125 8.984375 
Q 59.421875 11.28125 64.40625 15.921875 
L 64.40625 5.609375 
Q 59.234375 2.09375 53.4375 0.328125 
Q 47.65625 -1.421875 41.21875 -1.421875 
Q 24.65625 -1.421875 15.125 8.703125 
Q 5.609375 18.84375 5.609375 36.375 
Q 5.609375 53.953125 15.125 64.078125 
Q 24.65625 74.21875 41.21875 74.21875 
Q 47.75 74.21875 53.53125 72.484375 
Q 59.328125 70.75 64.40625 67.28125 
z
" id="DejaVuSans-67"></path></defs><g style="fill:#262626;" transform="translate(109.484766 257.087031)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-112"></use><use x="63.476562" xlink:href="#DejaVuSans-111"></use><use x="124.658203" xlink:href="#DejaVuSans-105"></use><use x="152.441406" xlink:href="#DejaVuSans-110"></use><use x="215.820312" xlink:href="#DejaVuSans-116"></use><use x="255.029297" xlink:href="#DejaVuSans-119"></use><use x="336.816406" xlink:href="#DejaVuSans-105"></use><use x="364.599609" xlink:href="#DejaVuSans-115"></use><use x="416.699219" xlink:href="#DejaVuSans-101"></use><use x="478.222656" xlink:href="#DejaVuSans-32"></use><use x="510.009766" xlink:href="#DejaVuSans-100"></use><use x="573.486328" xlink:href="#DejaVuSans-105"></use><use x="601.269531" xlink:href="#DejaVuSans-102"></use><use x="636.474609" xlink:href="#DejaVuSans-102"></use><use x="671.679688" xlink:href="#DejaVuSans-101"></use><use x="733.203125" xlink:href="#DejaVuSans-114"></use><use x="774.285156" xlink:href="#DejaVuSans-101"></use><use x="835.808594" xlink:href="#DejaVuSans-110"></use><use x="899.1875" xlink:href="#DejaVuSans-99"></use><use x="954.167969" xlink:href="#DejaVuSans-101"></use><use x="1015.691406" xlink:href="#DejaVuSans-32"></use><use x="1047.478516" xlink:href="#DejaVuSans-105"></use><use x="1075.261719" xlink:href="#DejaVuSans-110"></use><use x="1138.640625" xlink:href="#DejaVuSans-32"></use><use x="1170.427734" xlink:href="#DejaVuSans-87"></use><use x="1269.226562" xlink:href="#DejaVuSans-65"></use><use x="1337.634766" xlink:href="#DejaVuSans-73"></use><use x="1367.126953" xlink:href="#DejaVuSans-67"></use></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_13"><path clip-path="url(#p77e93ee763)" d="M 49.85625 190.709432 
L 384.65625 190.709432 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_8"><!-- −2 --><g style="fill:#262626;" transform="translate(25.717188 196.028338)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-50"></use></g></g></g><g id="ytick_2"><g id="line2d_15"><path clip-path="url(#p77e93ee763)" d="M 49.85625 148.02489 
L 384.65625 148.02489 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_9"><!-- −1 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(25.717188 153.343797)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-8722"></use><use x="83.789062" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_3"><g id="line2d_17"><path clip-path="url(#p77e93ee763)" d="M 49.85625 105.340349 
L 384.65625 105.340349 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_10"><!-- 0 --><g style="fill:#262626;" transform="translate(37.44875 110.659255)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_4"><g id="line2d_19"><path clip-path="url(#p77e93ee763)" d="M 49.85625 62.655807 
L 384.65625 62.655807 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_11"><!-- 1 --><g style="fill:#262626;" transform="translate(37.44875 67.974713)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use></g></g></g><g id="ytick_5"><g id="line2d_21"><path clip-path="url(#p77e93ee763)" d="M 49.85625 19.971266 
L 384.65625 19.971266 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_22"></g><g id="text_12"><!-- 2 --><g style="fill:#262626;" transform="translate(37.44875 25.290172)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-50"></use></g></g></g><g id="text_13"><!-- log longevity (std) --><defs><path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"></path><path d="M 45.40625 27.984375 
Q 45.40625 37.75 41.375 43.109375 
Q 37.359375 48.484375 30.078125 48.484375 
Q 22.859375 48.484375 18.828125 43.109375 
Q 14.796875 37.75 14.796875 27.984375 
Q 14.796875 18.265625 18.828125 12.890625 
Q 22.859375 7.515625 30.078125 7.515625 
Q 37.359375 7.515625 41.375 12.890625 
Q 45.40625 18.265625 45.40625 27.984375 
z
M 54.390625 6.78125 
Q 54.390625 -7.171875 48.1875 -13.984375 
Q 42 -20.796875 29.203125 -20.796875 
Q 24.46875 -20.796875 20.265625 -20.09375 
Q 16.0625 -19.390625 12.109375 -17.921875 
L 12.109375 -9.1875 
Q 16.0625 -11.328125 19.921875 -12.34375 
Q 23.78125 -13.375 27.78125 -13.375 
Q 36.625 -13.375 41.015625 -8.765625 
Q 45.40625 -4.15625 45.40625 5.171875 
L 45.40625 9.625 
Q 42.625 4.78125 38.28125 2.390625 
Q 33.9375 0 27.875 0 
Q 17.828125 0 11.671875 7.65625 
Q 5.515625 15.328125 5.515625 27.984375 
Q 5.515625 40.671875 11.671875 48.328125 
Q 17.828125 56 27.875 56 
Q 33.9375 56 38.28125 53.609375 
Q 42.625 51.21875 45.40625 46.390625 
L 45.40625 54.6875 
L 54.390625 54.6875 
z
" id="DejaVuSans-103"></path><path d="M 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 8.796875 
L 46.6875 54.6875 
L 56.203125 54.6875 
L 35.6875 0 
L 23.484375 0 
z
" id="DejaVuSans-118"></path><path d="M 32.171875 -5.078125 
Q 28.375 -14.84375 24.75 -17.8125 
Q 21.140625 -20.796875 15.09375 -20.796875 
L 7.90625 -20.796875 
L 7.90625 -13.28125 
L 13.1875 -13.28125 
Q 16.890625 -13.28125 18.9375 -11.515625 
Q 21 -9.765625 23.484375 -3.21875 
L 25.09375 0.875 
L 2.984375 54.6875 
L 12.5 54.6875 
L 29.59375 11.921875 
L 46.6875 54.6875 
L 56.203125 54.6875 
z
" id="DejaVuSans-121"></path><path d="M 31 75.875 
Q 24.46875 64.65625 21.28125 53.65625 
Q 18.109375 42.671875 18.109375 31.390625 
Q 18.109375 20.125 21.3125 9.0625 
Q 24.515625 -2 31 -13.1875 
L 23.1875 -13.1875 
Q 15.875 -1.703125 12.234375 9.375 
Q 8.59375 20.453125 8.59375 31.390625 
Q 8.59375 42.28125 12.203125 53.3125 
Q 15.828125 64.359375 23.1875 75.875 
z
" id="DejaVuSans-40"></path><path d="M 8.015625 75.875 
L 15.828125 75.875 
Q 23.140625 64.359375 26.78125 53.3125 
Q 30.421875 42.28125 30.421875 31.390625 
Q 30.421875 20.453125 26.78125 9.375 
Q 23.140625 -1.703125 15.828125 -13.1875 
L 8.015625 -13.1875 
Q 14.5 -2 17.703125 9.0625 
Q 20.90625 20.125 20.90625 31.390625 
Q 20.90625 42.671875 17.703125 53.65625 
Q 14.5 64.65625 8.015625 75.875 
z
" id="DejaVuSans-41"></path></defs><g style="fill:#262626;" transform="translate(18.597656 184.286016)rotate(-90)scale(0.15 -0.15)"><use xlink:href="#DejaVuSans-108"></use><use x="27.783203" xlink:href="#DejaVuSans-111"></use><use x="88.964844" xlink:href="#DejaVuSans-103"></use><use x="152.441406" xlink:href="#DejaVuSans-32"></use><use x="184.228516" xlink:href="#DejaVuSans-108"></use><use x="212.011719" xlink:href="#DejaVuSans-111"></use><use x="273.193359" xlink:href="#DejaVuSans-110"></use><use x="336.572266" xlink:href="#DejaVuSans-103"></use><use x="400.048828" xlink:href="#DejaVuSans-101"></use><use x="461.572266" xlink:href="#DejaVuSans-118"></use><use x="520.751953" xlink:href="#DejaVuSans-105"></use><use x="548.535156" xlink:href="#DejaVuSans-116"></use><use x="587.744141" xlink:href="#DejaVuSans-121"></use><use x="646.923828" xlink:href="#DejaVuSans-32"></use><use x="678.710938" xlink:href="#DejaVuSans-40"></use><use x="717.724609" xlink:href="#DejaVuSans-115"></use><use x="769.824219" xlink:href="#DejaVuSans-116"></use><use x="809.033203" xlink:href="#DejaVuSans-100"></use><use x="872.509766" xlink:href="#DejaVuSans-41"></use></g></g></g><g id="PathCollection_1"><defs><path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="mc36f756527" style="stroke:#000000;stroke-opacity:0.4;"></path></defs><g clip-path="url(#p77e93ee763)"><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="197.76793" xlink:href="#mc36f756527" y="114.564836"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="171.722926" xlink:href="#mc36f756527" y="127.183345"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="194.970295" xlink:href="#mc36f756527" y="106.139084"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="134.821041" xlink:href="#mc36f756527" y="128.687847"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="191.977989" xlink:href="#mc36f756527" y="106.139084"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="216.446398" xlink:href="#mc36f756527" y="139.334577"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="200.545621" xlink:href="#mc36f756527" y="104.933697"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="211.762074" xlink:href="#mc36f756527" y="172.218666"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="216.489883" xlink:href="#mc36f756527" y="94.687167"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="217.442178" xlink:href="#mc36f756527" y="110.264166"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="212.961942" xlink:href="#mc36f756527" y="97.245543"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="195.501923" xlink:href="#mc36f756527" y="64.361455"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="234.460661" xlink:href="#mc36f756527" y="98.362135"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="366.948502" xlink:href="#mc36f756527" y="139.334577"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="207.194153" xlink:href="#mc36f756527" y="139.897534"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="202.508221" xlink:href="#mc36f756527" y="146.30634"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="200.657082" xlink:href="#mc36f756527" y="146.30634"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="204.575471" xlink:href="#mc36f756527" y="157.086823"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="114.939621" xlink:href="#mc36f756527" y="49.013854"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="116.540635" xlink:href="#mc36f756527" y="46.518654"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="67.563998" xlink:href="#mc36f756527" y="26.833218"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="130.369984" xlink:href="#mc36f756527" y="56.149793"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="229.335983" xlink:href="#mc36f756527" y="123.757577"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="205.534116" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="197.240184" xlink:href="#mc36f756527" y="99.113443"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="199.141451" xlink:href="#mc36f756527" y="93.610242"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="187.613042" xlink:href="#mc36f756527" y="78.084265"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="235.893713" xlink:href="#mc36f756527" y="114.564836"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="194.914862" xlink:href="#mc36f756527" y="65.70702"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="286.392023" xlink:href="#mc36f756527" y="151.236609"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="198.641093" xlink:href="#mc36f756527" y="97.988565"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="194.391033" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="198.837528" xlink:href="#mc36f756527" y="101.016521"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="205.445122" xlink:href="#mc36f756527" y="114.564836"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="227.087882" xlink:href="#mc36f756527" y="133.871059"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="216.117975" xlink:href="#mc36f756527" y="109.843998"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="191.599884" xlink:href="#mc36f756527" y="157.758257"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="257.100196" xlink:href="#mc36f756527" y="132.28799"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="232.223706" xlink:href="#mc36f756527" y="139.334577"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="188.785324" xlink:href="#mc36f756527" y="82.464848"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="180.674749" xlink:href="#mc36f756527" y="108.180578"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="213.732263" xlink:href="#mc36f756527" y="86.04511"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="207.752208" xlink:href="#mc36f756527" y="109.008865"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="190.431138" xlink:href="#mc36f756527" y="110.68609"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="205.674965" xlink:href="#mc36f756527" y="137.113598"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="283.871601" xlink:href="#mc36f756527" y="66.523045"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="261.153184" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="200.561721" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="198.196995" xlink:href="#mc36f756527" y="157.758257"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="206.226818" xlink:href="#mc36f756527" y="180.307019"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="196.530908" xlink:href="#mc36f756527" y="148.127118"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="207.101449" xlink:href="#mc36f756527" y="145.110462"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="198.29753" xlink:href="#mc36f756527" y="164.73002"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="281.147008" xlink:href="#mc36f756527" y="28.319281"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="208.190945" xlink:href="#mc36f756527" y="144.517789"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="162.572256" xlink:href="#mc36f756527" y="180.307019"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="166.959282" xlink:href="#mc36f756527" y="49.013854"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="164.450472" xlink:href="#mc36f756527" y="58.644994"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="184.711685" xlink:href="#mc36f756527" y="69.291724"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="202.25157" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="265.450094" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="186.608664" xlink:href="#mc36f756527" y="106.950739"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="79.333967" xlink:href="#mc36f756527" y="214.167449"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="140.645278" xlink:href="#mc36f756527" y="180.307019"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="197.29413" xlink:href="#mc36f756527" y="79.007107"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="218.643384" xlink:href="#mc36f756527" y="99.113443"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="201.918614" xlink:href="#mc36f756527" y="148.741409"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="198.432435" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="184.047996" xlink:href="#mc36f756527" y="63.828205"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="201.909756" xlink:href="#mc36f756527" y="78.084265"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="195.00366" xlink:href="#mc36f756527" y="69.291724"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="199.217505" xlink:href="#mc36f756527" y="74.179898"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="224.41729" xlink:href="#mc36f756527" y="139.334577"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="198.792254" xlink:href="#mc36f756527" y="87.715404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="210.522858" xlink:href="#mc36f756527" y="58.644994"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="185.026761" xlink:href="#mc36f756527" y="72.138404"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="156.377926" xlink:href="#mc36f756527" y="119.056708"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="199.941395" xlink:href="#mc36f756527" y="76.866775"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="277.885359" xlink:href="#mc36f756527" y="43.799643"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="212.526054" xlink:href="#mc36f756527" y="154.44483"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="207.425357" xlink:href="#mc36f756527" y="180.307019"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="197.033507" xlink:href="#mc36f756527" y="155.757192"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="132.526524" xlink:href="#mc36f756527" y="123.757577"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="236.405724" xlink:href="#mc36f756527" y="100.250983"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="205.130028" xlink:href="#mc36f756527" y="134.940386"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="192.344088" xlink:href="#mc36f756527" y="145.110462"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="203.854502" xlink:href="#mc36f756527" y="40.221313"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="249.867241" xlink:href="#mc36f756527" y="17.672551"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="189.294625" xlink:href="#mc36f756527" y="105.333897"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="213.934124" xlink:href="#mc36f756527" y="46.742962"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="202.479068" xlink:href="#mc36f756527" y="65.166642"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="226.821198" xlink:href="#mc36f756527" y="58.644994"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="230.691946" xlink:href="#mc36f756527" y="46.742962"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="228.470725" xlink:href="#mc36f756527" y="102.175813"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="214.847753" xlink:href="#mc36f756527" y="125.211566"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="259.393142" xlink:href="#mc36f756527" y="17.672551"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="157.776715" xlink:href="#mc36f756527" y="151.236609"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="185.228999" xlink:href="#mc36f756527" y="125.700916"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="184.948949" xlink:href="#mc36f756527" y="106.139084"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="203.957663" xlink:href="#mc36f756527" y="108.180578"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="194.496043" xlink:href="#mc36f756527" y="155.098881"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="185.738429" xlink:href="#mc36f756527" y="114.126438"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="165.903652" xlink:href="#mc36f756527" y="98.362135"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="168.694675" xlink:href="#mc36f756527" y="106.139084"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="202.373777" xlink:href="#mc36f756527" y="63.828205"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="203.153881" xlink:href="#mc36f756527" y="180.307019"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="197.780419" xlink:href="#mc36f756527" y="157.758257"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="187.201604" xlink:href="#mc36f756527" y="94.687167"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="223.35671" xlink:href="#mc36f756527" y="84.076532"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="187.8812" xlink:href="#mc36f756527" y="106.139084"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="182.964229" xlink:href="#mc36f756527" y="114.564836"></use><use style="fill:#2a2eec;fill-opacity:0.4;stroke:#000000;stroke-opacity:0.4;" x="274.465705" xlink:href="#mc36f756527" y="81.193756"></use></g></g><g id="line2d_23"><path clip-path="url(#p77e93ee763)" d="M 49.85625 105.340349 
L 384.65625 105.340349 
" style="fill:none;stroke:#000000;stroke-dasharray:3.7,1.6;stroke-dashoffset:0;"></path></g><g id="line2d_24"><path clip-path="url(#p77e93ee763)" d="M 202.209275 224.64 
L 202.209275 7.2 
" style="fill:none;stroke:#000000;stroke-dasharray:3.7,1.6;stroke-dashoffset:0;"></path></g><g id="patch_3"><path d="M 49.85625 224.64 
L 49.85625 7.2 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 384.65625 224.64 
L 384.65625 7.2 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 49.85625 224.64 
L 384.65625 224.64 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 49.85625 7.2 
L 384.65625 7.2 
" style="fill:none;"></path></g></g></g><defs><clippath id="p77e93ee763"><rect height="217.44" width="334.8" x="49.85625" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.45">Code 7.45<a class="anchor-link" href="07-ulysses-compass.html#Code-7.45">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">log_M</span><span class="p">,</span> <span class="n">log_L</span><span class="p">,</span> <span class="n">log_B</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
    <span class="n">bM</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bM"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">bL</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"bL"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">bM</span> <span class="o">*</span> <span class="n">log_M</span> <span class="o">+</span> <span class="n">bL</span> <span class="o">*</span> <span class="n">log_L</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"log_B"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">log_B</span><span class="p">)</span>

<span class="n">m7_11</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m7_11</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">log_M</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_M</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">log_L</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_L</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">log_B</span><span class="o">=</span><span class="n">d2</span><span class="o">.</span><span class="n">log_B</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">p7_11</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">post</span> <span class="o">=</span> <span class="n">m7_11</span><span class="o">.</span><span class="n">sample_posterior</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p7_11</span><span class="p">,</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,))</span>
<span class="n">summary</span><span class="p">(</span><span class="n">post</span><span class="p">,</span> <span class="mf">0.89</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[45]:</span>
</div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>

                mean       std    median      5.5%     94.5%     n_eff     r_hat
         a     -0.05      0.02     -0.05     -0.07     -0.02   1049.96      1.00
        bL      0.12      0.03      0.12      0.07      0.16    793.11      1.00
        bM      0.94      0.03      0.94      0.89      0.98    894.41      1.00
     sigma      0.19      0.01      0.19      0.17      0.21    967.01      1.00


</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.46">Code 7.46<a class="anchor-link" href="07-ulysses-compass.html#Code-7.46">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Howell1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"../data/Howell1.csv"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">";"</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Howell1</span>
<span class="n">d</span><span class="p">[</span><span class="s2">"age"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">age</span> <span class="o">-</span> <span class="n">d</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">d</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">d1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-7.47">Code 7.47<a class="anchor-link" href="07-ulysses-compass.html#Code-7.47">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"a"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">HalfCauchy</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">age</span>
    <span class="n">npyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">"height"</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">AutoLaplaceApproximation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">svi</span> <span class="o">=</span> <span class="n">SVI</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">AutoContinuousELBO</span><span class="p">(),</span>
          <span class="n">age</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">state</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">svi</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">init_state</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3000</span><span class="p">))</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">svi</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">coef</span><span class="p">[</span><span class="s2">"a"</span><span class="p">]</span> <span class="o">+</span> <span class="n">coef</span><span class="p">[</span><span class="s2">"b"</span><span class="p">]</span> <span class="o">*</span> <span class="n">d2</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">values</span>
<span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">coef</span><span class="p">[</span><span class="s2">"sigma"</span><span class="p">])</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">d2</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[47]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(-1205.3535, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="06-the-haunted-dag-and-the-causal-terror.html">Chapter 6. The Haunted DAG &amp; The Causal Terror</a> | <a href="08-conditional-manatees.html">Chapter 8. Conditional Manatees</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
</div>
    </div>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><!--End of body content--><footer id="footer"><div class="text-center">
  Contents © 2019         <a href="mailto:fehiepsi@gmail.com">Du Phan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>

</div>

            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-131299125-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131299125-1');
</script>
</body>
</html>
