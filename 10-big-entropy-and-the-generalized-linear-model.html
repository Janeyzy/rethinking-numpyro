<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Chapter 10. Big Entropy and the Generalized Linear Model | Statistical Rethinking (2nd ed.) with NumPyro</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://fehiepsi.github.io/rethinking-numpyro/10-big-entropy-and-the-generalized-linear-model.html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><meta name="author" content="fehiepsi">
<meta property="og:site_name" content="Statistical Rethinking (2nd ed.) with NumPyro">
<meta property="og:title" content="Chapter 10. Big Entropy and the Generalized Linear Model">
<meta property="og:url" content="https://fehiepsi.github.io/rethinking-numpyro/10-big-entropy-and-the-generalized-linear-model.html">
<meta property="og:description" content="&lt; Chapter 9. Markov Chain Monte Carlo | Chapter 11. God Spiked the Integers &gt;

    
    
    
    









In [0]:

    
import arviz as az

from jax import vmap
import jax.numpy as np
from jax.rando">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2019-11-02T00:01:47-04:00">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href="https://fehiepsi.github.io/rethinking-numpyro/">

            <span id="blog-title">Statistical Rethinking (2nd ed.) with NumPyro</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav"></ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100"></ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Chapter 10. Big Entropy and the Generalized Linear Model</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="09-markov-chain-monte-carlo.html">Chapter 9. Markov Chain Monte Carlo</a> | <a href="11-god-spiked-the-integers.html">Chapter 11. God Spiked the Integers</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>

<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">vmap</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">jax.random</span> <span class="kn">import</span> <span class="n">PRNGKey</span>
<span class="kn">from</span> <span class="nn">jax.tree_util</span> <span class="kn">import</span> <span class="n">tree_map</span>

<span class="kn">import</span> <span class="nn">numpyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = ["svg"]
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"arviz-darkgrid"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.1">Code 10.1<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.1">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"A"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"B"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"C"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"D"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="s2">"E"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.2">Code 10.2<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.2">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_norm</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">q</span><span class="p">:</span> <span class="n">q</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.3">Code 10.3<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.3">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">q</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">q</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">q</span><span class="p">))),</span> <span class="n">p_norm</span><span class="p">)</span>
<span class="n">H</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[3]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>{'A': DeviceArray(-0., dtype=float32),
 'B': DeviceArray(0.6390318, dtype=float32),
 'C': DeviceArray(0.95027053, dtype=float32),
 'D': DeviceArray(1.4708084, dtype=float32),
 'E': DeviceArray(1.609438, dtype=float32)}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.4">Code 10.4<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.4">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ways</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">1260</span><span class="p">,</span> <span class="mi">37800</span><span class="p">,</span> <span class="mi">113400</span><span class="p">])</span>
<span class="n">logwayspp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ways</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.5">Code 10.5<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.5">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># build list of the candidate distributions</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">])</span>

<span class="c1"># compute expected value of each</span>
<span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])),</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[5]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>{1: DeviceArray(1., dtype=float32),
 2: DeviceArray(1., dtype=float32),
 3: DeviceArray(1., dtype=float32),
 4: DeviceArray(1., dtype=float32)}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.6">Code 10.6<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.6">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># compute entropy of each distribution</span>
<span class="n">tree_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[6]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>{1: DeviceArray(1.3862944, dtype=float32),
 2: DeviceArray(1.3296614, dtype=float32),
 3: DeviceArray(1.3296614, dtype=float32),
 4: DeviceArray(1.2130076, dtype=float32)}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.7">Code 10.7<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.7">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span> <span class="o">**</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[7]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([0.09, 0.21, 0.21, 0.49], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.8">Code 10.8<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.8">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[8]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(1.2217286, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.9">Code 10.9<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.9">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sim_p</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mf">1.4</span><span class="p">):</span>
    <span class="n">x123</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">Uniform</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">PRNGKey</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
    <span class="n">x4</span> <span class="o">=</span> <span class="p">(</span><span class="n">G</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x123</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">x123</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x123</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">G</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x123</span><span class="p">,</span> <span class="n">x4</span><span class="p">]))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x123</span><span class="p">,</span> <span class="n">x4</span><span class="p">])</span> <span class="o">/</span> <span class="n">z</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">"H"</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)),</span> <span class="s2">"p"</span><span class="p">:</span> <span class="n">p</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.10">Code 10.10<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.10">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">sim_p</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mf">1.4</span><span class="p">))(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)))</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_kde</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="s2">"H"</span><span class="p">],</span> <span class="n">bw</span><span class="o">=</span><span class="mf">0.25</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[10]:</span>
</div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?><!-- Created with matplotlib (https://matplotlib.org/) --><svg height="292.377375pt" version="1.1" viewbox="0 0 437.475 292.377375" width="437.475pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style></defs><g id="figure_1"><g id="patch_1"><path d="M 0 292.377375 
L 437.475 292.377375 
L 437.475 0 
L 0 0 
z
" style="fill:#ffffff;"></path></g><g id="axes_1"><g id="patch_2"><path d="M 28.515 268.128 
L 430.275 268.128 
L 430.275 7.2 
L 28.515 7.2 
z
" style="fill:#eeeeee;"></path></g><g id="matplotlib.axis_1"><g id="xtick_1"><g id="line2d_1"><path clip-path="url(#pa5c8db389b)" d="M 31.673735 268.128 
L 31.673735 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_2"></g><g id="text_1"><!-- 0.6 --><defs><path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path><path d="M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
" id="DejaVuSans-46"></path><path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"></path></defs><g style="fill:#262626;" transform="translate(20.541548 282.265812)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-54"></use></g></g></g><g id="xtick_2"><g id="line2d_3"><path clip-path="url(#pa5c8db389b)" d="M 92.848287 268.128 
L 92.848287 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_4"></g><g id="text_2"><!-- 0.7 --><defs><path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"></path></defs><g style="fill:#262626;" transform="translate(81.7161 282.265812)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-55"></use></g></g></g><g id="xtick_3"><g id="line2d_5"><path clip-path="url(#pa5c8db389b)" d="M 154.02284 268.128 
L 154.02284 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_6"></g><g id="text_3"><!-- 0.8 --><defs><path d="M 31.78125 34.625 
Q 24.75 34.625 20.71875 30.859375 
Q 16.703125 27.09375 16.703125 20.515625 
Q 16.703125 13.921875 20.71875 10.15625 
Q 24.75 6.390625 31.78125 6.390625 
Q 38.8125 6.390625 42.859375 10.171875 
Q 46.921875 13.96875 46.921875 20.515625 
Q 46.921875 27.09375 42.890625 30.859375 
Q 38.875 34.625 31.78125 34.625 
z
M 21.921875 38.8125 
Q 15.578125 40.375 12.03125 44.71875 
Q 8.5 49.078125 8.5 55.328125 
Q 8.5 64.0625 14.71875 69.140625 
Q 20.953125 74.21875 31.78125 74.21875 
Q 42.671875 74.21875 48.875 69.140625 
Q 55.078125 64.0625 55.078125 55.328125 
Q 55.078125 49.078125 51.53125 44.71875 
Q 48 40.375 41.703125 38.8125 
Q 48.828125 37.15625 52.796875 32.3125 
Q 56.78125 27.484375 56.78125 20.515625 
Q 56.78125 9.90625 50.3125 4.234375 
Q 43.84375 -1.421875 31.78125 -1.421875 
Q 19.734375 -1.421875 13.25 4.234375 
Q 6.78125 9.90625 6.78125 20.515625 
Q 6.78125 27.484375 10.78125 32.3125 
Q 14.796875 37.15625 21.921875 38.8125 
z
M 18.3125 54.390625 
Q 18.3125 48.734375 21.84375 45.5625 
Q 25.390625 42.390625 31.78125 42.390625 
Q 38.140625 42.390625 41.71875 45.5625 
Q 45.3125 48.734375 45.3125 54.390625 
Q 45.3125 60.0625 41.71875 63.234375 
Q 38.140625 66.40625 31.78125 66.40625 
Q 25.390625 66.40625 21.84375 63.234375 
Q 18.3125 60.0625 18.3125 54.390625 
z
" id="DejaVuSans-56"></path></defs><g style="fill:#262626;" transform="translate(142.890652 282.265812)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-56"></use></g></g></g><g id="xtick_4"><g id="line2d_7"><path clip-path="url(#pa5c8db389b)" d="M 215.197392 268.128 
L 215.197392 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_8"></g><g id="text_4"><!-- 0.9 --><defs><path d="M 10.984375 1.515625 
L 10.984375 10.5 
Q 14.703125 8.734375 18.5 7.8125 
Q 22.3125 6.890625 25.984375 6.890625 
Q 35.75 6.890625 40.890625 13.453125 
Q 46.046875 20.015625 46.78125 33.40625 
Q 43.953125 29.203125 39.59375 26.953125 
Q 35.25 24.703125 29.984375 24.703125 
Q 19.046875 24.703125 12.671875 31.3125 
Q 6.296875 37.9375 6.296875 49.421875 
Q 6.296875 60.640625 12.9375 67.421875 
Q 19.578125 74.21875 30.609375 74.21875 
Q 43.265625 74.21875 49.921875 64.515625 
Q 56.59375 54.828125 56.59375 36.375 
Q 56.59375 19.140625 48.40625 8.859375 
Q 40.234375 -1.421875 26.421875 -1.421875 
Q 22.703125 -1.421875 18.890625 -0.6875 
Q 15.09375 0.046875 10.984375 1.515625 
z
M 30.609375 32.421875 
Q 37.25 32.421875 41.125 36.953125 
Q 45.015625 41.5 45.015625 49.421875 
Q 45.015625 57.28125 41.125 61.84375 
Q 37.25 66.40625 30.609375 66.40625 
Q 23.96875 66.40625 20.09375 61.84375 
Q 16.21875 57.28125 16.21875 49.421875 
Q 16.21875 41.5 20.09375 36.953125 
Q 23.96875 32.421875 30.609375 32.421875 
z
" id="DejaVuSans-57"></path></defs><g style="fill:#262626;" transform="translate(204.065205 282.265812)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-57"></use></g></g></g><g id="xtick_5"><g id="line2d_9"><path clip-path="url(#pa5c8db389b)" d="M 276.371945 268.128 
L 276.371945 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_10"></g><g id="text_5"><!-- 1.0 --><defs><path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path></defs><g style="fill:#262626;" transform="translate(265.239757 282.265812)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-48"></use></g></g></g><g id="xtick_6"><g id="line2d_11"><path clip-path="url(#pa5c8db389b)" d="M 337.546497 268.128 
L 337.546497 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_12"></g><g id="text_6"><!-- 1.1 --><g style="fill:#262626;" transform="translate(326.414309 282.265812)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-49"></use></g></g></g><g id="xtick_7"><g id="line2d_13"><path clip-path="url(#pa5c8db389b)" d="M 398.721049 268.128 
L 398.721049 7.2 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_14"></g><g id="text_7"><!-- 1.2 --><defs><path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path></defs><g style="fill:#262626;" transform="translate(387.588862 282.265812)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-46"></use><use x="95.410156" xlink:href="#DejaVuSans-50"></use></g></g></g></g><g id="matplotlib.axis_2"><g id="ytick_1"><g id="line2d_15"><path clip-path="url(#pa5c8db389b)" d="M 28.515 256.267636 
L 430.275 256.267636 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_16"></g><g id="text_8"><!-- 0 --><g style="fill:#262626;" transform="translate(16.1075 261.586543)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-48"></use></g></g></g><g id="ytick_2"><g id="line2d_17"><path clip-path="url(#pa5c8db389b)" d="M 28.515 213.729952 
L 430.275 213.729952 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_18"></g><g id="text_9"><!-- 2 --><g style="fill:#262626;" transform="translate(16.1075 219.048858)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-50"></use></g></g></g><g id="ytick_3"><g id="line2d_19"><path clip-path="url(#pa5c8db389b)" d="M 28.515 171.192268 
L 430.275 171.192268 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_20"></g><g id="text_10"><!-- 4 --><defs><path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"></path></defs><g style="fill:#262626;" transform="translate(16.1075 176.511174)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-52"></use></g></g></g><g id="ytick_4"><g id="line2d_21"><path clip-path="url(#pa5c8db389b)" d="M 28.515 128.654584 
L 430.275 128.654584 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_22"></g><g id="text_11"><!-- 6 --><g style="fill:#262626;" transform="translate(16.1075 133.97349)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-54"></use></g></g></g><g id="ytick_5"><g id="line2d_23"><path clip-path="url(#pa5c8db389b)" d="M 28.515 86.116899 
L 430.275 86.116899 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_24"></g><g id="text_12"><!-- 8 --><g style="fill:#262626;" transform="translate(16.1075 91.435806)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-56"></use></g></g></g><g id="ytick_6"><g id="line2d_25"><path clip-path="url(#pa5c8db389b)" d="M 28.515 43.579215 
L 430.275 43.579215 
" style="fill:none;stroke:#ffffff;stroke-linecap:round;stroke-width:0.8;"></path></g><g id="line2d_26"></g><g id="text_13"><!-- 10 --><g style="fill:#262626;" transform="translate(7.2 48.898121)scale(0.14 -0.14)"><use xlink:href="#DejaVuSans-49"></use><use x="63.623047" xlink:href="#DejaVuSans-48"></use></g></g></g></g><g id="PolyCollection_1"><defs><path d="M 46.776818 -36.109739 
L 46.776818 -36.208493 
L 48.612177 -36.109739 
L 50.447535 -36.109739 
L 52.282894 -36.208493 
L 54.118253 -36.109739 
L 55.953611 -36.208493 
L 57.78897 -36.504755 
L 59.624328 -36.109739 
L 61.459687 -36.208493 
L 63.295046 -36.208493 
L 65.130404 -36.208493 
L 66.965763 -36.208493 
L 68.801122 -36.406001 
L 70.63648 -36.504755 
L 72.471839 -36.504755 
L 74.307197 -36.603509 
L 76.142556 -36.208493 
L 77.977915 -36.208493 
L 79.813273 -36.208493 
L 81.648632 -36.208493 
L 83.48399 -36.307247 
L 85.319349 -36.504755 
L 87.154708 -36.801017 
L 88.990066 -36.801017 
L 90.825425 -36.702263 
L 92.660783 -36.603509 
L 94.496142 -36.801017 
L 96.331501 -37.294787 
L 98.166859 -37.196033 
L 100.002218 -36.702263 
L 101.837577 -37.097279 
L 103.672935 -36.998525 
L 105.508294 -37.59105 
L 107.343652 -37.492296 
L 109.179011 -36.998525 
L 111.01437 -37.294787 
L 112.849728 -37.196033 
L 114.685087 -37.294787 
L 116.520445 -37.393542 
L 118.355804 -37.196033 
L 120.191163 -38.08482 
L 122.026521 -38.677344 
L 123.86188 -37.788558 
L 125.697238 -37.788558 
L 127.532597 -37.788558 
L 129.367956 -38.381082 
L 131.203314 -38.973607 
L 133.038673 -37.986066 
L 134.874032 -38.677344 
L 136.70939 -39.072361 
L 138.544749 -38.381082 
L 140.380107 -38.677344 
L 142.215466 -38.282328 
L 144.050825 -38.677344 
L 145.886183 -39.664885 
L 147.721542 -38.874853 
L 149.5569 -39.072361 
L 151.392259 -38.57859 
L 153.227618 -39.072361 
L 155.062976 -39.072361 
L 156.898335 -39.269869 
L 158.733693 -40.948688 
L 160.569052 -39.961147 
L 162.404411 -40.158655 
L 164.239769 -41.047442 
L 166.075128 -39.862393 
L 167.910487 -41.541212 
L 169.745845 -41.146196 
L 171.581204 -41.639966 
L 173.416562 -41.936229 
L 175.251921 -42.232491 
L 177.08728 -41.837475 
L 178.922638 -41.146196 
L 180.757997 -42.825015 
L 182.593355 -41.837475 
L 184.428714 -42.726261 
L 186.264073 -42.627507 
L 188.099431 -43.022523 
L 189.93479 -44.997605 
L 191.770148 -43.318786 
L 193.605507 -42.627507 
L 195.440866 -45.392621 
L 197.276224 -44.602589 
L 199.111583 -43.615048 
L 200.946942 -44.997605 
L 202.7823 -44.40508 
L 204.617659 -46.281408 
L 206.453017 -45.195113 
L 208.288376 -46.775178 
L 210.123735 -47.762719 
L 211.959093 -48.453997 
L 213.794452 -47.367702 
L 215.62981 -47.663965 
L 217.465169 -47.367702 
L 219.300528 -49.836554 
L 221.135886 -49.935308 
L 222.971245 -51.021603 
L 224.806603 -49.935308 
L 226.641962 -52.996684 
L 228.477321 -52.305406 
L 230.312679 -53.391701 
L 232.148038 -53.490455 
L 233.983397 -55.663044 
L 235.818755 -56.156815 
L 237.654114 -57.144355 
L 239.489472 -55.860552 
L 241.324831 -59.514453 
L 243.16019 -57.934388 
L 244.995548 -58.921928 
L 246.830907 -62.082059 
L 248.666265 -64.05714 
L 250.501624 -63.464616 
L 252.336983 -68.599827 
L 254.172341 -67.711041 
L 256.0077 -69.093598 
L 257.843058 -73.636285 
L 259.678417 -72.154974 
L 261.513776 -75.808874 
L 263.349134 -80.944086 
L 265.184493 -80.944086 
L 267.019852 -79.759037 
L 268.85521 -80.845332 
L 270.690569 -81.53661 
L 272.525927 -83.412937 
L 274.361286 -85.289265 
L 276.196645 -82.820413 
L 278.032003 -85.585527 
L 279.867362 -90.621984 
L 281.70272 -89.436936 
L 283.538079 -88.153133 
L 285.373438 -88.745657 
L 287.208796 -91.017001 
L 289.044155 -96.053458 
L 290.879513 -97.337261 
L 292.714872 -97.139753 
L 294.550231 -98.818572 
L 296.385589 -101.18867 
L 298.220948 -99.608605 
L 300.056307 -99.904867 
L 301.891665 -100.596145 
L 303.727024 -102.472473 
L 305.562382 -108.496471 
L 307.397741 -104.941324 
L 309.2331 -108.200209 
L 311.068458 -107.01516 
L 312.903817 -111.261585 
L 314.739175 -111.459093 
L 316.574534 -116.890567 
L 318.409893 -116.100534 
L 320.245251 -120.248205 
L 322.08061 -121.136992 
L 323.915968 -117.976861 
L 325.751327 -122.815811 
L 327.586686 -122.618303 
L 329.422044 -128.938563 
L 331.257403 -130.32112 
L 333.092762 -133.580004 
L 334.92812 -131.111153 
L 336.763479 -140.789051 
L 338.598837 -135.258823 
L 340.434196 -144.837968 
L 342.269555 -148.886885 
L 344.104913 -142.270362 
L 345.940272 -150.269442 
L 347.77563 -149.874426 
L 349.610989 -148.590623 
L 351.446348 -157.083473 
L 353.281706 -153.232064 
L 355.117065 -160.539865 
L 356.952423 -159.651078 
L 358.787782 -163.699995 
L 360.623141 -166.95888 
L 362.458499 -167.057634 
L 364.293858 -173.27914 
L 366.129217 -173.77291 
L 367.964575 -178.315597 
L 369.799934 -177.328057 
L 371.635292 -178.019335 
L 373.470651 -185.524644 
L 375.30601 -187.697234 
L 377.141368 -190.166086 
L 378.976727 -193.622478 
L 380.812085 -200.436509 
L 382.647444 -200.634017 
L 384.482803 -200.337755 
L 386.318161 -208.139326 
L 388.15352 -204.781688 
L 389.988878 -204.682934 
L 391.824237 -209.126867 
L 393.659596 -206.855523 
L 395.494954 -209.028113 
L 397.330313 -219.002274 
L 399.165672 -211.39821 
L 401.00103 -216.928438 
L 402.836389 -226.705091 
L 404.671747 -223.742469 
L 406.507106 -232.432827 
L 408.342465 -239.740628 
L 410.177823 -243.592037 
L 412.013182 -273.317011 
L 412.013182 -36.109739 
L 412.013182 -36.109739 
L 410.177823 -36.109739 
L 408.342465 -36.109739 
L 406.507106 -36.109739 
L 404.671747 -36.109739 
L 402.836389 -36.109739 
L 401.00103 -36.109739 
L 399.165672 -36.109739 
L 397.330313 -36.109739 
L 395.494954 -36.109739 
L 393.659596 -36.109739 
L 391.824237 -36.109739 
L 389.988878 -36.109739 
L 388.15352 -36.109739 
L 386.318161 -36.109739 
L 384.482803 -36.109739 
L 382.647444 -36.109739 
L 380.812085 -36.109739 
L 378.976727 -36.109739 
L 377.141368 -36.109739 
L 375.30601 -36.109739 
L 373.470651 -36.109739 
L 371.635292 -36.109739 
L 369.799934 -36.109739 
L 367.964575 -36.109739 
L 366.129217 -36.109739 
L 364.293858 -36.109739 
L 362.458499 -36.109739 
L 360.623141 -36.109739 
L 358.787782 -36.109739 
L 356.952423 -36.109739 
L 355.117065 -36.109739 
L 353.281706 -36.109739 
L 351.446348 -36.109739 
L 349.610989 -36.109739 
L 347.77563 -36.109739 
L 345.940272 -36.109739 
L 344.104913 -36.109739 
L 342.269555 -36.109739 
L 340.434196 -36.109739 
L 338.598837 -36.109739 
L 336.763479 -36.109739 
L 334.92812 -36.109739 
L 333.092762 -36.109739 
L 331.257403 -36.109739 
L 329.422044 -36.109739 
L 327.586686 -36.109739 
L 325.751327 -36.109739 
L 323.915968 -36.109739 
L 322.08061 -36.109739 
L 320.245251 -36.109739 
L 318.409893 -36.109739 
L 316.574534 -36.109739 
L 314.739175 -36.109739 
L 312.903817 -36.109739 
L 311.068458 -36.109739 
L 309.2331 -36.109739 
L 307.397741 -36.109739 
L 305.562382 -36.109739 
L 303.727024 -36.109739 
L 301.891665 -36.109739 
L 300.056307 -36.109739 
L 298.220948 -36.109739 
L 296.385589 -36.109739 
L 294.550231 -36.109739 
L 292.714872 -36.109739 
L 290.879513 -36.109739 
L 289.044155 -36.109739 
L 287.208796 -36.109739 
L 285.373438 -36.109739 
L 283.538079 -36.109739 
L 281.70272 -36.109739 
L 279.867362 -36.109739 
L 278.032003 -36.109739 
L 276.196645 -36.109739 
L 274.361286 -36.109739 
L 272.525927 -36.109739 
L 270.690569 -36.109739 
L 268.85521 -36.109739 
L 267.019852 -36.109739 
L 265.184493 -36.109739 
L 263.349134 -36.109739 
L 261.513776 -36.109739 
L 259.678417 -36.109739 
L 257.843058 -36.109739 
L 256.0077 -36.109739 
L 254.172341 -36.109739 
L 252.336983 -36.109739 
L 250.501624 -36.109739 
L 248.666265 -36.109739 
L 246.830907 -36.109739 
L 244.995548 -36.109739 
L 243.16019 -36.109739 
L 241.324831 -36.109739 
L 239.489472 -36.109739 
L 237.654114 -36.109739 
L 235.818755 -36.109739 
L 233.983397 -36.109739 
L 232.148038 -36.109739 
L 230.312679 -36.109739 
L 228.477321 -36.109739 
L 226.641962 -36.109739 
L 224.806603 -36.109739 
L 222.971245 -36.109739 
L 221.135886 -36.109739 
L 219.300528 -36.109739 
L 217.465169 -36.109739 
L 215.62981 -36.109739 
L 213.794452 -36.109739 
L 211.959093 -36.109739 
L 210.123735 -36.109739 
L 208.288376 -36.109739 
L 206.453017 -36.109739 
L 204.617659 -36.109739 
L 202.7823 -36.109739 
L 200.946942 -36.109739 
L 199.111583 -36.109739 
L 197.276224 -36.109739 
L 195.440866 -36.109739 
L 193.605507 -36.109739 
L 191.770148 -36.109739 
L 189.93479 -36.109739 
L 188.099431 -36.109739 
L 186.264073 -36.109739 
L 184.428714 -36.109739 
L 182.593355 -36.109739 
L 180.757997 -36.109739 
L 178.922638 -36.109739 
L 177.08728 -36.109739 
L 175.251921 -36.109739 
L 173.416562 -36.109739 
L 171.581204 -36.109739 
L 169.745845 -36.109739 
L 167.910487 -36.109739 
L 166.075128 -36.109739 
L 164.239769 -36.109739 
L 162.404411 -36.109739 
L 160.569052 -36.109739 
L 158.733693 -36.109739 
L 156.898335 -36.109739 
L 155.062976 -36.109739 
L 153.227618 -36.109739 
L 151.392259 -36.109739 
L 149.5569 -36.109739 
L 147.721542 -36.109739 
L 145.886183 -36.109739 
L 144.050825 -36.109739 
L 142.215466 -36.109739 
L 140.380107 -36.109739 
L 138.544749 -36.109739 
L 136.70939 -36.109739 
L 134.874032 -36.109739 
L 133.038673 -36.109739 
L 131.203314 -36.109739 
L 129.367956 -36.109739 
L 127.532597 -36.109739 
L 125.697238 -36.109739 
L 123.86188 -36.109739 
L 122.026521 -36.109739 
L 120.191163 -36.109739 
L 118.355804 -36.109739 
L 116.520445 -36.109739 
L 114.685087 -36.109739 
L 112.849728 -36.109739 
L 111.01437 -36.109739 
L 109.179011 -36.109739 
L 107.343652 -36.109739 
L 105.508294 -36.109739 
L 103.672935 -36.109739 
L 101.837577 -36.109739 
L 100.002218 -36.109739 
L 98.166859 -36.109739 
L 96.331501 -36.109739 
L 94.496142 -36.109739 
L 92.660783 -36.109739 
L 90.825425 -36.109739 
L 88.990066 -36.109739 
L 87.154708 -36.109739 
L 85.319349 -36.109739 
L 83.48399 -36.109739 
L 81.648632 -36.109739 
L 79.813273 -36.109739 
L 77.977915 -36.109739 
L 76.142556 -36.109739 
L 74.307197 -36.109739 
L 72.471839 -36.109739 
L 70.63648 -36.109739 
L 68.801122 -36.109739 
L 66.965763 -36.109739 
L 65.130404 -36.109739 
L 63.295046 -36.109739 
L 61.459687 -36.109739 
L 59.624328 -36.109739 
L 57.78897 -36.109739 
L 55.953611 -36.109739 
L 54.118253 -36.109739 
L 52.282894 -36.109739 
L 50.447535 -36.109739 
L 48.612177 -36.109739 
L 46.776818 -36.109739 
z
" id="m16c2fc9663" style="stroke:#2a2eec;stroke-opacity:0;"></path></defs><g clip-path="url(#pa5c8db389b)"><use style="fill:#2a2eec;fill-opacity:0;stroke:#2a2eec;stroke-opacity:0;" x="0" xlink:href="#m16c2fc9663" y="292.377375"></use></g></g><g id="line2d_27"><path clip-path="url(#pa5c8db389b)" d="M 46.776818 256.168882 
L 50.447535 256.267636 
L 52.282894 256.168882 
L 54.118253 256.267636 
L 55.953611 256.168882 
L 57.78897 255.87262 
L 59.624328 256.267636 
L 63.295046 256.168882 
L 66.965763 256.168882 
L 70.63648 255.87262 
L 74.307197 255.773866 
L 76.142556 256.168882 
L 83.48399 256.070128 
L 88.990066 255.576358 
L 92.660783 255.773866 
L 94.496142 255.576358 
L 96.331501 255.082588 
L 98.166859 255.181342 
L 100.002218 255.675112 
L 101.837577 255.280096 
L 103.672935 255.37885 
L 105.508294 254.786325 
L 107.343652 254.885079 
L 109.179011 255.37885 
L 111.01437 255.082588 
L 112.849728 255.181342 
L 116.520445 254.983833 
L 118.355804 255.181342 
L 120.191163 254.292555 
L 122.026521 253.700031 
L 123.86188 254.588817 
L 127.532597 254.588817 
L 131.203314 253.403768 
L 133.038673 254.391309 
L 134.874032 253.700031 
L 136.70939 253.305014 
L 138.544749 253.996293 
L 140.380107 253.700031 
L 142.215466 254.095047 
L 144.050825 253.700031 
L 145.886183 252.71249 
L 147.721542 253.502522 
L 149.5569 253.305014 
L 151.392259 253.798785 
L 153.227618 253.305014 
L 155.062976 253.305014 
L 156.898335 253.107506 
L 158.733693 251.428687 
L 160.569052 252.416228 
L 162.404411 252.21872 
L 164.239769 251.329933 
L 166.075128 252.514982 
L 167.910487 250.836163 
L 169.745845 251.231179 
L 171.581204 250.737409 
L 175.251921 250.144884 
L 177.08728 250.5399 
L 178.922638 251.231179 
L 180.757997 249.55236 
L 182.593355 250.5399 
L 184.428714 249.651114 
L 186.264073 249.749868 
L 188.099431 249.354852 
L 189.93479 247.37977 
L 191.770148 249.058589 
L 193.605507 249.749868 
L 195.440866 246.984754 
L 197.276224 247.774786 
L 199.111583 248.762327 
L 200.946942 247.37977 
L 202.7823 247.972295 
L 204.617659 246.095967 
L 206.453017 247.182262 
L 208.288376 245.602197 
L 210.123735 244.614656 
L 211.959093 243.923378 
L 213.794452 245.009673 
L 215.62981 244.71341 
L 217.465169 245.009673 
L 219.300528 242.540821 
L 221.135886 242.442067 
L 222.971245 241.355772 
L 224.806603 242.442067 
L 226.641962 239.380691 
L 228.477321 240.071969 
L 230.312679 238.985674 
L 232.148038 238.88692 
L 233.983397 236.714331 
L 235.818755 236.22056 
L 237.654114 235.23302 
L 239.489472 236.516823 
L 241.324831 232.862922 
L 243.16019 234.442987 
L 244.995548 233.455447 
L 246.830907 230.295316 
L 248.666265 228.320235 
L 250.501624 228.912759 
L 252.336983 223.777548 
L 254.172341 224.666334 
L 256.0077 223.283777 
L 257.843058 218.74109 
L 259.678417 220.222401 
L 261.513776 216.568501 
L 263.349134 211.433289 
L 265.184493 211.433289 
L 267.019852 212.618338 
L 268.85521 211.532043 
L 270.690569 210.840765 
L 274.361286 207.08811 
L 276.196645 209.556962 
L 278.032003 206.791848 
L 279.867362 201.755391 
L 283.538079 204.224242 
L 285.373438 203.631718 
L 287.208796 201.360374 
L 289.044155 196.323917 
L 290.879513 195.040114 
L 292.714872 195.237622 
L 294.550231 193.558803 
L 296.385589 191.188705 
L 298.220948 192.76877 
L 300.056307 192.472508 
L 301.891665 191.78123 
L 303.727024 189.904902 
L 305.562382 183.880904 
L 307.397741 187.436051 
L 309.2331 184.177166 
L 311.068458 185.362215 
L 312.903817 181.11579 
L 314.739175 180.918282 
L 316.574534 175.486808 
L 318.409893 176.276841 
L 320.245251 172.12917 
L 322.08061 171.240383 
L 323.915968 174.400514 
L 325.751327 169.561564 
L 327.586686 169.759072 
L 329.422044 163.438812 
L 331.257403 162.056255 
L 333.092762 158.797371 
L 334.92812 161.266222 
L 336.763479 151.588324 
L 338.598837 157.118552 
L 340.434196 147.539407 
L 342.269555 143.49049 
L 344.104913 150.107013 
L 345.940272 142.107933 
L 347.77563 142.502949 
L 349.610989 143.786752 
L 351.446348 135.293902 
L 353.281706 139.145311 
L 355.117065 131.83751 
L 356.952423 132.726297 
L 358.787782 128.67738 
L 360.623141 125.418495 
L 362.458499 125.319741 
L 364.293858 119.098235 
L 366.129217 118.604465 
L 367.964575 114.061778 
L 369.799934 115.049318 
L 371.635292 114.35804 
L 373.470651 106.852731 
L 375.30601 104.680141 
L 377.141368 102.211289 
L 378.976727 98.754897 
L 380.812085 91.940866 
L 382.647444 91.743358 
L 384.482803 92.03962 
L 386.318161 84.238049 
L 388.15352 87.595687 
L 389.988878 87.694441 
L 391.824237 83.250508 
L 393.659596 85.521852 
L 395.494954 83.349262 
L 397.330313 73.375101 
L 399.165672 80.979165 
L 401.00103 75.448937 
L 402.836389 65.672284 
L 404.671747 68.634906 
L 406.507106 59.944548 
L 408.342465 52.636747 
L 410.177823 48.785338 
L 412.013182 19.060364 
L 412.013182 19.060364 
" style="fill:none;stroke:#2a2eec;stroke-linecap:round;stroke-width:1.5;"></path></g><g id="patch_3"><path d="M 28.515 268.128 
L 28.515 7.2 
" style="fill:none;"></path></g><g id="patch_4"><path d="M 430.275 268.128 
L 430.275 7.2 
" style="fill:none;"></path></g><g id="patch_5"><path d="M 28.515 268.128 
L 430.275 268.128 
" style="fill:none;"></path></g><g id="patch_6"><path d="M 28.515 7.2 
L 430.275 7.2 
" style="fill:none;"></path></g></g></g><defs><clippath id="pa5c8db389b"><rect height="260.928" width="401.76" x="28.515" y="7.2"></rect></clippath></defs></svg>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.11">Code 10.11<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.11">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">entropies</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="s2">"H"</span><span class="p">]</span>
<span class="n">distributions</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="s2">"p"</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.12">Code 10.12<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.12">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">entropies</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[12]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(1.2217282, dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Code-10.13">Code 10.13<a class="anchor-link" href="10-big-entropy-and-the-generalized-linear-model.html#Code-10.13">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distributions</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">entropies</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    
<div class="prompt output_prompt">
<span>Out[13]:</span>
</div>




<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([0.09018064, 0.20994425, 0.20969447, 0.49018064], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
    <div class="inner_cell">
    <div class="text_cell_render border-box-sizing rendered_html">
    <div class="navigation">
    <p><!-- NAVIGATION -->
&lt; <a href="09-markov-chain-monte-carlo.html">Chapter 9. Markov Chain Monte Carlo</a> | <a href="11-god-spiked-the-integers.html">Chapter 11. God Spiked the Integers</a> &gt;</p>

    </div>
    </div>
    </div>
    </div>
</div>
    </div>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><!--End of body content--><footer id="footer"><div class="text-center">
  Contents © 2019         <a href="mailto:fehiepsi@gmail.com">Du Phan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>

</div>

            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-131299125-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131299125-1');
</script>
</body>
</html>
